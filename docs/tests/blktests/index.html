<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Zoned Storage Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Zoned Storage Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><title data-react-helmet="true">Kernel Block Layer Tests | Zoned Storage</title><meta data-react-helmet="true" property="og:url" content="https://zonedstorage.io/docs/tests/blktests"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Kernel Block Layer Tests | Zoned Storage"><meta data-react-helmet="true" name="description" content="blktests is a test suite for Linux;reg; kernel storage stack, that is, the"><meta data-react-helmet="true" property="og:description" content="blktests is a test suite for Linux;reg; kernel storage stack, that is, the"><link data-react-helmet="true" rel="shortcut icon" href="/img/zs-logo.ico"><link data-react-helmet="true" rel="canonical" href="https://zonedstorage.io/docs/tests/blktests"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/tests/blktests" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/tests/blktests" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.30532e53.css">
<link rel="preload" href="/assets/js/runtime~main.de1a87e7.js" as="script">
<link rel="preload" href="/assets/js/main.e827f9a4.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/community/support">Community</a></li><li class="menu__list-item"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zoned-storage">Zoned Storage Devices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/smr">Shingled Magnetic Recording</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zns">NVMe Zoned Namespaces (ZNS) SSDs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/prerequisites">System Prerequisites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/nullblk">Zoned Block Device Emulation with nullblk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-disk">Getting Started with SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-emulation">Getting Started with Emulated SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/zns-emulation">Getting Started with Emulated NVMe ZNS Devices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Linux Kernel Support</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/overview">Linux Kernel Zoned Storage Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/config">Kernel Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/zbd-api">Zoned Block Device User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/sched">Write Ordering Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/part">Zoned Block Device Partition Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/dm">Device Mapper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/fs">File Systems</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/percona-server">Percona Server for MySQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/zenfs">RocksDB with ZenFS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tools and Libraries</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/util-linux">Linux System Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/zns">ZNS Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/sg3utils">SCSI Generic Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/libzbc">libzbc User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/libzbd">libzbd User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/libnvme">libnvme User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/tcmu-runner">tcmu-runner ZBC Disk Emulation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/qemu">QEMU and KVM</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">System Compliance Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tests">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tests/zbc-tests">ZBC/ZAC Compliance Tests</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tests/blktests">Kernel Block Layer Tests</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/distributions/linux">Linux Distributions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/benchmarking/benchmark">Benchmarking Zoned Block Devices</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq/faq">Frequently Asked Questions</a></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Kernel Block Layer Tests</h1></header><div class="markdown"><p><em>blktests</em> is a test suite for Linux;reg; kernel storage stack, that is, the
block I/O layer as well as underlying device specific layers (SCSI, NVMe, SRP,
etc). <em>blktests</em> is heavily inspired by the <em>xfstests</em> framework for testing
file systems.</p><p>Recent contributions to <em>blktests</em> added zoned block device tests support.</p><p>The <em>blktests</em> project is hosted on
<a href="https://github.com/osandov/blktests" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p><em>blktests</em> organizes test cases into groups. The test groups currently available
are as shown in the table below.</p><center><table><thead><tr><th align="left">Group name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><strong>block</strong></td><td align="left">Block layer generic tests</td></tr><tr><td align="left"><strong>loop</strong></td><td align="left">Loopback device tests</td></tr><tr><td align="left"><strong>meta</strong></td><td align="left"><em>blktests</em> self tests</td></tr><tr><td align="left"><strong>nbd</strong></td><td align="left">Network block device driver tests</td></tr><tr><td align="left"><strong>nvme</strong></td><td align="left">NVMe driver tests</td></tr><tr><td align="left"><strong>nvmeof-mp</strong></td><td align="left">NVME-over-fabrics multipath tests</td></tr><tr><td align="left"><strong>scsi</strong></td><td align="left">SCSI layer tests</td></tr><tr><td align="left"><strong>srp</strong></td><td align="left">SCSI RDMA Protocol driver tests</td></tr><tr><td align="left"><strong>zbd</strong></td><td align="left">Zoned block device tests</td></tr></tbody></table></center><p>The test groups supporting zoned block devices are <em>block</em> and <em>zbd</em>.
<a href="/docs/tools/util-linux#blkzone"><em>blkzone</em></a> and <a href="/docs/benchmarking/benchmark"><em>fio</em></a>
version 3.9 or higher must be installed for executing these test groups.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><p>Detailed generic information on how to configure and run <em>blktests</em> is
provided <a href="https://github.com/osandov/blktests/blob/master/Documentation/running-tests.md" target="_blank" rel="noopener noreferrer">here</a>.</p><p>For executing tests against a physical zoned block device (e.g. a ZBC/ZAC disk),
the following <code>config</code> file should be prepared and copied to the <em>blktests</em>
installation directory. Tests can also be executed directly from the source
directory if the <code>config</code> file is copied in that location.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Tests target device list</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TEST_DEVS</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/sdd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Enable zoned block device mode for the block group genertic tests </span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">RUN_ZONED_TESTS</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>With this configuration, all tests relevant to zoned block devices will be
executed. The execution duration can be several 10s of minutes depending on the
target device and host system. To Shorten execution, the options <code>TIMEOUT</code> and
<code>QUICK_RUN</code> can be added to the configuration.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Tests target device list</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TEST_DEVS</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/sdd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Enable zoned block device mode for the block group genertic tests</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">RUN_ZONED_TESTS</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Speed up execution (weaker tests)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">QUICK_RUN</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TIMEOUT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">30</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Of note is that the block layer generic tests of the <em>block</em> group also include
test cases executed against a logical device (<em>null_blk</em> block device). These
tests are executed twice, once with the <em>null_blk</em> device configured as a
regular block device and a second time with the <em>null_blk</em> device configured as
a zoned block device. To reduce the test cases execution to only the physical
device specified in the configuration file, the <code>DEVICE_ONLY</code> option can be set.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Tests target device list</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TEST_DEVS</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/sdd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Enable zoned block device mode for the block group genertic tests</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">RUN_ZONED_TESTS</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Speed up execution (weaker tests)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">QUICK_RUN</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TIMEOUT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">30</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Exercise only the devices in TEST_DEVS</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DEVICE_ONLY</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="execution"></a>Execution<a class="hash-link" href="#execution" title="Direct link to heading">#</a></h2><p><em>blktests</em> execution is done using the <code>check</code> script present in the top level
directory. This script optionally takes as argument a list of test groups or
test cases to execute. Bu default, without any argument, all test groups will be
executed.</p><p>For zoned block device tests, executing the test cases of the <em>block</em> and <em>zbd</em>
test groups is sufficient.</p><p>As discussed in the <a href="#configuration">configuration</a> section above, several
options can speedup the execution of <em>blktests</em>. Such quick runs are indeed
faster but at the cost of weaker testing compared to full runs.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="full-run"></a>Full Run<a class="hash-link" href="#full-run" title="Direct link to heading">#</a></h3><p>The following command executes all test cases relevant to zoned block devices
with the device specified in the <code>config</code> configuration file as target. In this
example, no options are added.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># ./check block zbd</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/001 (stress device hotplugging)                        [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  120.013s  ...  123.440s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/002 (remove a device while running blktrace)           [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.741s  ...  0.761s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/003 =&gt; sdd (run various discard sizes)                 [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/004 =&gt; sdd (run lots of flushes)                       [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime     98.876s  ...  82.665s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write iops  170      ...  203</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/005 =&gt; sdd (switch schedulers while doing IO)          [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    read iops  1415    ...  791</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    6.765s  ...  11.242s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/006 (run null-blk in blocking mode)                    [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    read iops  154220   ...  152356</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    19.158s  ...  19.229s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/006 (zoned) (run null-blk in blocking mode)            [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    read iops  150692   ...  146826</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    19.128s  ...  19.720s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/007 =&gt; sdd (test classic and hybrid IO polling)        [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/008 (do IO while hotplugging CPUs)                     [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    CPU hotplugging is not supported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/009 (check page-cache coherency after BLKDISCARD)      [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.827s  ...  0.868s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/010 (run I/O on null_blk with shared and non-shared tags) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Individual tags read iops  254661    ...  253371</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Shared tags read iops      174876    ...  174933</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime                    695.714s  ...  715.579s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/010 (zoned) (run I/O on null_blk with shared and non-shared tags) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Individual tags read iops  253356    ...  252487</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Shared tags read iops      174871    ...  174780</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime                    667.479s  ...  652.577s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/011 =&gt; sdd (disable PCI device while doing I/O)        [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.293s  ...  17.760s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/012 =&gt; sdd (check that a read-only block device fails writes) [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/013 =&gt; sdd (try BLKRRPART on a mounted device)         [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/014 (run null-blk with blk-mq and timeout injection configured) [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    null_blk module does not have parameter timeout</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/015 (run null-blk on different schedulers with requeue injection configured) [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    null_blk module does not have parameter requeue</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/016 (send a signal to a process waiting on a frozen queue) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.055s  ...  8.055s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/016 (zoned) (send a signal to a process waiting on a frozen queue) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.055s  ...  8.055s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/017 (do I/O and check the inflight counter)            [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.691s  ...  1.675s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/017 (zoned) (do I/O and check the inflight counter)    [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.690s  ...  1.692s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/018 (do I/O and check iostats times)                   [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  5.075s  ...  5.077s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/019 =&gt; sdd (break PCI link device while doing I/O)     [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/020 (run null-blk on different schedulers with only one hardware tag) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  43.139s  ...  43.191s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/020 (zoned) (run null-blk on different schedulers with only one hardware tag) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  43.120s  ...  43.206s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/021 (read/write nr_requests on null-blk with different schedulers) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.396s  ...  1.393s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/021 (zoned) (read/write nr_requests on null-blk with different schedulers) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.399s  ...  1.419s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/023 (do I/O on all null_blk queue modes)               [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.276s  ...  0.280s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/023 (zoned) (do I/O on all null_blk queue modes)       [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.279s  ...  0.302s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/024 (do I/O faster than a jiffy and check iostats times) [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  4.902s  ...  4.904s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/025 (do a huge discard with 4k sector size)            [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.869s  ...  8.921s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/027 (stress device hotplugging with running fio jobs and different schedulers) [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    no support for io cgroup controller; if it is enabled, you may need to boot with cgroup_no_v1=io</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/028 (do I/O on scsi_debug with DIF/DIX enabled)        [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  19.924s  ...  19.942s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/001 =&gt; sdd (sysfs and ioctl)                             [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  0.706s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/002 =&gt; sdd (report zone)                                 [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  6.534s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/003 =&gt; sdd (reset sequential required zones)             [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  13.324s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/004 =&gt; sdd (write split across sequential zones)         [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  17.019s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/005 =&gt; sdd (write command ordering)                      [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime       ...  178.335s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write io      ...  7196672</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write iops    ...  933</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/006 =&gt; sdd (revalidate)                                  [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime       ...  61.028s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write io      ...  1805004</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write iops    ...  15041</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The output of some tests is <em>[not run]</em>. This is not a failure. This only
indicates that the target device specified in the configuration file does not
support the feature being tested. For example, in the above run, test case
<em>block/003</em> is not executed against the specified host managed disk because the
disk does not support the <em>discard</em> command.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="quick-run"></a>Quick Run<a class="hash-link" href="#quick-run" title="Direct link to heading">#</a></h3><p><em>blkltests</em> execution can be accelerated using the <code>TIMEOUT</code>, <code>QUICK_RUN</code> and
<code>DEVICE_ONLY</code> configuration options.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Tests target device list</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TEST_DEVS</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/sdd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Enable zoned block device mode for the block group genertic tests</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">RUN_ZONED_TESTS</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Speed up execution (weaker tests)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">QUICK_RUN</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TIMEOUT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">30</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Exercise only the devices in TEST_DEVS</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DEVICE_ONLY</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Running only the <em>block</em> and <em>zbd</em> test groups with the above configuration
gives the following results.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># ./check block zbd</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/003 =&gt; sdd (run various discard sizes)                 [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/004 =&gt; sdd (run lots of flushes)                       [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime     913.097s  ...  33.714s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write iops            ...  239</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/005 =&gt; sdd (switch schedulers while doing IO)          [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    read iops  2975     ...  3573</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    22.510s  ...  19.194s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/007 =&gt; sdd (test classic and hybrid IO polling)        [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/008 =&gt; sdd (do IO while hotplugging CPUs)              [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/011 =&gt; sdd (disable PCI device while doing I/O)        [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  30.322s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/012 =&gt; sdd (check that a read-only block device fails writes) [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/013 =&gt; sdd (try BLKRRPART on a mounted device)         [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">block/019 =&gt; sdd (break PCI link device while doing I/O)     [not run]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/001 =&gt; sdd (sysfs and ioctl)                             [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.328s  ...  0.521s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/003 =&gt; sdd (reset sequential required zones)             [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  9.591s  ...  11.008s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/004 =&gt; sdd (write split across sequential zones)         [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime  11.772s  ...  11.743s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/005 =&gt; sdd (write command ordering)                      [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime     59.688s  ...  167.521s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write io    7201536  ...  7113472</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write iops  933      ...  921</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zbd/006 =&gt; sdd (revalidate)                                  [passed]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    runtime     7.063s  ...  39.464s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write io            ...  2097152</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    write iops          ...  48971</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tests/zbc-tests"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« ZBC/ZAC Compliance Tests</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/distributions/linux"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Linux Distributions Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li><li><a href="#execution" class="table-of-contents__link">Execution</a><ul><li><a href="#full-run" class="table-of-contents__link">Full Run</a></li><li><a href="#quick-run" class="table-of-contents__link">Quick Run</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting Started with Zoned Storage</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix</a></li><li class="footer__item"><a href="https://join.slack.com/t/zonedstorage/shared_invite/zt-uyfut5xe-nKajp9YRnEWqiD4X6RkTFw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://webchat.oftc.net/?channels=zonedstorage" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC @ OFTC</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.de1a87e7.js"></script>
<script src="/assets/js/main.e827f9a4.js"></script>
</body>
</html>