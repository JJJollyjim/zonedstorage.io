<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Zoned Storage Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Zoned Storage Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><title data-react-helmet="true">libzbd User Library | Zoned Storage</title><meta data-react-helmet="true" property="og:url" content="https://zonedstorage.io/docs/tools/libzbd"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="libzbd User Library | Zoned Storage"><meta data-react-helmet="true" name="description" content="libzbd is a user library providing functions for manipulating zoned block"><meta data-react-helmet="true" property="og:description" content="libzbd is a user library providing functions for manipulating zoned block"><link data-react-helmet="true" rel="shortcut icon" href="/img/zs-logo.ico"><link data-react-helmet="true" rel="canonical" href="https://zonedstorage.io/docs/tools/libzbd"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/tools/libzbd" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/tools/libzbd" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.30532e53.css">
<link rel="preload" href="/assets/js/runtime~main.18692684.js" as="script">
<link rel="preload" href="/assets/js/main.e827f9a4.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/community/support">Community</a></li><li class="menu__list-item"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zoned-storage">Zoned Storage Devices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/smr">Shingled Magnetic Recording</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zns">NVMe Zoned Namespaces (ZNS) SSDs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/prerequisites">System Prerequisites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/nullblk">Zoned Block Device Emulation with nullblk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-disk">Getting Started with SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-emulation">Getting Started with Emulated SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/zns-emulation">Getting Started with Emulated NVMe ZNS Devices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Linux Kernel Support</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/overview">Linux Kernel Zoned Storage Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/config">Kernel Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/zbd-api">Zoned Block Device User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/sched">Write Ordering Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/part">Zoned Block Device Partition Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/dm">Device Mapper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/fs">File Systems</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/percona-server">Percona Server for MySQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/zenfs">RocksDB with ZenFS</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tools and Libraries</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/util-linux">Linux System Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/zns">ZNS Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/sg3utils">SCSI Generic Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/libzbc">libzbc User Library</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tools/libzbd">libzbd User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/libnvme">libnvme User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/tcmu-runner">tcmu-runner ZBC Disk Emulation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/qemu">QEMU and KVM</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">System Compliance Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/zbc-tests">ZBC/ZAC Compliance Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/blktests">Kernel Block Layer Tests</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/distributions/linux">Linux Distributions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/benchmarking/benchmark">Benchmarking Zoned Block Devices</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq/faq">Frequently Asked Questions</a></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">libzbd User Library</h1></header><div class="markdown"><p><em>libzbd</em> is a user library providing functions for manipulating zoned block
devices.</p><p>Unlike the <a href="/docs/tools/libzbc"><em>libzbc</em></a> library, <em>libzbd</em> does not implement direct
command access to zoned block devices. Rather, <em>libzbd</em> uses the kernel provided
zoned block device interface based on the <em>ioctl()</em> system call. A direct
consequence of this is that <em>libzbd</em> will only allow access to zoned block
devices supported by the kernel running. This includes both physical devices
such as hard-disks supporting the ZBC and ZAC standards, as well as all logical
block devices implemented by various device drivers such as
<a href="/docs/getting-started/nullblk"><em>null_blk</em></a> and <a href="/docs/linux/dm">device mapper</a>
drivers.</p><p>The <em>libzbd</em> project is hosted on <a href="https://github.com/westerndigitalcorporation/libzbd" target="_blank" rel="noopener noreferrer">GitHub</a>.
The project <a href="https://github.com/westerndigitalcorporation/libzbd/blob/master/README.md" target="_blank" rel="noopener noreferrer"><em>README</em> file</a> provides information on how to compile and
install <em>libzbd</em> library and its tools.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p><em>libzbd</em> provides functions for discovering and managing the state of zones of
zoned block devices. Read and write accesses to the devices can be done using
standard standard I/O system calls.</p><p>The execution of <em>libzbd</em> functions as well as of write operations to zones of a
device may result in changes to the condition or attributes of the device zones
(such as write pointer location in sequential zones). These changes are not
internally tracked by <em>libzbd</em>. In other words, <em>libzbd</em> is stateless. It is the
responsibility of applications to implement tracking of the changes to zones
conditions such as the increasing write pointer position of a sequential zone
after the completion of a write request to the zone.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="library-functions"></a>Library Functions<a class="hash-link" href="#library-functions" title="Direct link to heading">#</a></h2><p>All <em>libzbd</em> functions use bytes unit for zones information such as the zone
start position on the device, a zone size or the zone write pointer location.
Zoned block devices are identified using regular file descriptor numbers that
can be used as is with standard I/O system calls.</p><p>However, application programmers must be careful to always implement read
accesses aligned to the device logical block size. Furthermore, on host managed
zoned block devices, write operations to sequential zones must be aligned
to the device physical block size.</p><p>The main functions provided by <em>libzbd</em> are as follows.</p><center><table><thead><tr><th align="left">Function</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">zbd_open()</td><td align="left">Open a zoned block device</td></tr><tr><td align="left">zbd_close()</td><td align="left">Close an open zoned block device</td></tr><tr><td align="left">zbd_get_info()</td><td align="left">Get a device information</td></tr><tr><td align="left">zbd_report_nr_zones()</td><td align="left">Get the number of zones of a device</td></tr><tr><td align="left">zbd_report_zones()</td><td align="left">Get a device zone information</td></tr><tr><td align="left">zbd_list_zones()</td><td align="left">Get a device zone information</td></tr><tr><td align="left">zbd_zones_operation()</td><td align="left">Execute an operation on a range of zones</td></tr><tr><td align="left">zbd_open_zones()</td><td align="left">Explicitly open a range of zone</td></tr><tr><td align="left">zbd_close_zones()</td><td align="left">Close a range of zones</td></tr><tr><td align="left">zbd_reset_zones()</td><td align="left">Reset the write pointer of a range of zones</td></tr><tr><td align="left">zbd_finish_zones()</td><td align="left">Finish a range of zone</td></tr></tbody></table></center><p>More detailed information about these functions usage and behavior can be found
in the comments of <a href="https://github.com/westerndigitalcorporation/libzbd/blob/master/include/libzbd/zbd.h" target="_blank" rel="noopener noreferrer"><em>libzbd</em> header file</a>. This header file is by default
installed as <code>/usr/include/libzbd/zbd.h</code>.</p><p><em>libzbd</em> does not implement any mutual exclusion mechanism for multi-thread or
multi-process applications. This implies that it is the responsibility of
applications to synchronize the execution of conflicting operations targeting
the same zone. A typical example of such case is concurrent write operations to
the same zone by multiple threads which may result in write errors without
write ordering control by the application.</p><p>The following functions are also provided by <em>libzbd</em> to facilitate application
development and tests.</p><center><table><thead><tr><th align="left">Function</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">zbd_device_is_zoned()</td><td align="left">Test if a device is a zoned block device</td></tr><tr><td align="left">zbd_device_model_str()</td><td align="left">Get a string description of a device model</td></tr><tr><td align="left">zbd_zone_type_str()</td><td align="left">Get a string description of a zone type</td></tr><tr><td align="left">zbd_zone_cond_str()</td><td align="left">Get a string description of a zone condition</td></tr><tr><td align="left">zbd_set_log_level()</td><td align="left">Set the library verbosity level</td></tr></tbody></table></center><p>All functions will behave in the same manner regardless of the type of disk
being used.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="utilities"></a>Utilities<a class="hash-link" href="#utilities" title="Direct link to heading">#</a></h2><p><em>libzbd</em> also provides several command line applications to manipulate zoned
block devices by calling the library functions. The list of applications
provided is shown in the table below.</p><center><table><thead><tr><th align="left">Tool</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">zbd</td><td align="left">Command line utility to report, open, close, reset and finish zones of a device</td></tr><tr><td align="left">gzbd</td><td align="left">Similar to the zbd tool but using a graphical user interface</td></tr><tr><td align="left">gzbd-viewer</td><td align="left">Graphical user interface showing the condition and state of zones of a zoned block device</td></tr></tbody></table></center><p>All utilities output a help message when executed without any argument.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># zbd</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Usage: zbd &lt;command&gt; [options] &lt;dev&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Command:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  report    : Get zone information</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  reset     : Reset zone(s)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  open      : Explicitly open zone(s)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  close     : Close zone(s)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  finish    : Finish zone(s)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Common options:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -v           : Verbose mode (for debug)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -i           : Display device information</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -ofst &lt;ofst (B)&gt; : Start offset of the first zone of the</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             target range (default: 0)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -len &lt;len (B)&gt;   : Size of the zone range to operate on</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             (default: device capacity)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -u &lt;unit (B)&gt;    : Size unit for the ofst and len options</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             and for displaying zone report results.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             (default: 1)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Report command options:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -csv      : Use csv output format</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -n        : Only output the number of zones in the report</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -ro &lt;opt&gt; : Specify zone report filter.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;em&quot;: empty zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;oi&quot;: implicitly open zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;oe&quot;: explicitly open zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;cl&quot;: closed zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;fu&quot;: full zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;ro&quot;: read-only zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;ol&quot;: offline zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;nw&quot;: conventional zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;ns&quot;: non-seq write resource zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          * &quot;rw&quot;: reset-wp recommended zones</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Manual pages are also provided for each tool.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># man zbd</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ZBD(8)                     System Manager&#x27;s Manual                       ZBD(8)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">NAME</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       zbd - manage zoned block devices</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SYNOPSIS</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       zbd command [options] device</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">DESCRIPTION</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       zbd  is  used  to  manipulate  zones of a zoned block device. Zoned block</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       devies are block devices that support the SCSI Zoned Block Commands</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       (ZBC), ATA  Zoned-device  ATA  Commands (ZAC)  or  NVMe  Zoned NameSpace</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       commands (ZNS).  The zones to operate on can be specified using the</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       offset and length options.</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       The device argument must be the pathname of the target zoned block</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       device.</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">COMMANDS</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   report</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       The command zbd report is used to obtain and display the device zone</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       information.</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       By default, the command will report all zones from the start of the</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       device up to the  last zone  of  the  device.  Options may be used to</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       modify this behavior, changing the starting zone or the size of the</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       report.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zbd-tool-examples"></a><em>zbd</em> Tool Examples<a class="hash-link" href="#zbd-tool-examples" title="Direct link to heading">#</a></h3><p>The following examples use a null zoned block device with 4 conventional zones
and 12 sequential zones of 32 MB created using the
<a href="/docs/getting-started/nullblk#creating-a-zoned-null-block-device"><em>nullblk-zoned.sh</em></a>
script.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nullblk-zoned.sh 4096 32 4 12</span></div><div class="token-line" style="color:#393A34"><span class="token plain">### Created /dev/nullb0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The following command can be used to list the zone information for all zones of
a device, including the device information such as logical block size and
capacity.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># zbd report -i /dev/nullb0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Device /dev/nullb0:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Vendor ID: Unknown</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Zone model: host-managed</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Capacity: 0.537 GB (1048576 512-bytes sectors)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Logical blocks: 131072 blocks of 4096 B</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Physical blocks: 131072 blocks of 4096 B</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Zones: 16 zones of 32.0 MB</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Maximum number of open zones: no limit</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Maximum number of active zones: no limit</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00000: cnv, ofst 00000000000000, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00001: cnv, ofst 00000033554432, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00002: cnv, ofst 00000067108864, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00003: cnv, ofst 00000100663296, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00004: swr, ofst 00000134217728, len 00000033554432, cap 00000033554432, wp 00000134217728, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00005: swr, ofst 00000167772160, len 00000033554432, cap 00000033554432, wp 00000167772160, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00006: swr, ofst 00000201326592, len 00000033554432, cap 00000033554432, wp 00000201326592, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00007: swr, ofst 00000234881024, len 00000033554432, cap 00000033554432, wp 00000234881024, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00008: swr, ofst 00000268435456, len 00000033554432, cap 00000033554432, wp 00000268435456, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00009: swr, ofst 00000301989888, len 00000033554432, cap 00000033554432, wp 00000301989888, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00010: swr, ofst 00000335544320, len 00000033554432, cap 00000033554432, wp 00000335544320, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00011: swr, ofst 00000369098752, len 00000033554432, cap 00000033554432, wp 00000369098752, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00012: swr, ofst 00000402653184, len 00000033554432, cap 00000033554432, wp 00000402653184, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00013: swr, ofst 00000436207616, len 00000033554432, cap 00000033554432, wp 00000436207616, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00014: swr, ofst 00000469762048, len 00000033554432, cap 00000033554432, wp 00000469762048, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00015: swr, ofst 00000503316480, len 00000033554432, cap 00000033554432, wp 00000503316480, em, non_seq 0, reset 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The same zone information can also be obtained in csv format to facilitate
parsing using scripting languages, including shell scripts.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># zbd report -csv /dev/nullb0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zone num, type, ofst, len, cap, wp, cond, non_seq, reset</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00000, 1, 00000000000000, 00000033554432, 00000033554432, 00000033554432, 0x0, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00001, 1, 00000033554432, 00000033554432, 00000033554432, 00000067108864, 0x0, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00002, 1, 00000067108864, 00000033554432, 00000033554432, 00000100663296, 0x0, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00003, 1, 00000100663296, 00000033554432, 00000033554432, 00000134217728, 0x0, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00004, 2, 00000134217728, 00000033554432, 00000033554432, 00000134217728, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00005, 2, 00000167772160, 00000033554432, 00000033554432, 00000167772160, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00006, 2, 00000201326592, 00000033554432, 00000033554432, 00000201326592, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00007, 2, 00000234881024, 00000033554432, 00000033554432, 00000234881024, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00008, 2, 00000268435456, 00000033554432, 00000033554432, 00000268435456, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00009, 2, 00000301989888, 00000033554432, 00000033554432, 00000301989888, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00010, 2, 00000335544320, 00000033554432, 00000033554432, 00000335544320, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00011, 2, 00000369098752, 00000033554432, 00000033554432, 00000369098752, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00012, 2, 00000402653184, 00000033554432, 00000033554432, 00000402653184, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00013, 2, 00000436207616, 00000033554432, 00000033554432, 00000436207616, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00014, 2, 00000469762048, 00000033554432, 00000033554432, 00000469762048, 0x1, 0, 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">00015, 2, 00000503316480, 00000033554432, 00000033554432, 00000503316480, 0x1, 0, 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zone-operations"></a>Zone Operations<a class="hash-link" href="#zone-operations" title="Direct link to heading">#</a></h3><p>The <em>zbd</em> tool also allow executing zone management operations over a range of
zones. The following example explicitely opens the first 2 sequential zones of
the <em>null_blk</em> device.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># zbd open -ofst 134217728 -len 67108864 /dev/nullb0 </span></div><div class="token-line" style="color:#393A34"><span class="token plain"># zbd report /dev/nullb0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00000: cnv, ofst 00000000000000, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00001: cnv, ofst 00000033554432, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00002: cnv, ofst 00000067108864, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00003: cnv, ofst 00000100663296, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00004: swr, ofst 00000134217728, len 00000033554432, cap 00000033554432, wp 00000134217728, {==oe==}, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00005: swr, ofst 00000167772160, len 00000033554432, cap 00000033554432, wp 00000167772160, {==oe==}, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00006: swr, ofst 00000201326592, len 00000033554432, cap 00000033554432, wp 00000201326592, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00007: swr, ofst 00000234881024, len 00000033554432, cap 00000033554432, wp 00000234881024, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00008: swr, ofst 00000268435456, len 00000033554432, cap 00000033554432, wp 00000268435456, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00009: swr, ofst 00000301989888, len 00000033554432, cap 00000033554432, wp 00000301989888, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00010: swr, ofst 00000335544320, len 00000033554432, cap 00000033554432, wp 00000335544320, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00011: swr, ofst 00000369098752, len 00000033554432, cap 00000033554432, wp 00000369098752, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00012: swr, ofst 00000402653184, len 00000033554432, cap 00000033554432, wp 00000402653184, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00013: swr, ofst 00000436207616, len 00000033554432, cap 00000033554432, wp 00000436207616, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00014: swr, ofst 00000469762048, len 00000033554432, cap 00000033554432, wp 00000469762048, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00015: swr, ofst 00000503316480, len 00000033554432, cap 00000033554432, wp 00000503316480, em, non_seq 0, reset 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Writing 32MB to the first zone using dd will transition the zone to full state.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># dd if=/dev/zero of=/dev/nullb0 oflag=direct bs=1M count=32 seek=128</span></div><div class="token-line" style="color:#393A34"><span class="token plain">32+0 records in</span></div><div class="token-line" style="color:#393A34"><span class="token plain">32+0 records out</span></div><div class="token-line" style="color:#393A34"><span class="token plain">33554432 bytes (34 MB, 32 MiB) copied, 0.00945045 s, 3.6 GB/s</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># zbd report /dev/nullb0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00000: cnv, ofst 00000000000000, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00001: cnv, ofst 00000033554432, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00002: cnv, ofst 00000067108864, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00003: cnv, ofst 00000100663296, len 00000033554432, cap 00000033554432</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00004: swr, ofst 00000134217728, len 00000033554432, cap 00000033554432, wp 00000167772160, {==fu==}, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00005: swr, ofst 00000167772160, len 00000033554432, cap 00000033554432, wp 00000167772160, oe, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00006: swr, ofst 00000201326592, len 00000033554432, cap 00000033554432, wp 00000201326592, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00007: swr, ofst 00000234881024, len 00000033554432, cap 00000033554432, wp 00000234881024, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00008: swr, ofst 00000268435456, len 00000033554432, cap 00000033554432, wp 00000268435456, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00009: swr, ofst 00000301989888, len 00000033554432, cap 00000033554432, wp 00000301989888, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00010: swr, ofst 00000335544320, len 00000033554432, cap 00000033554432, wp 00000335544320, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00011: swr, ofst 00000369098752, len 00000033554432, cap 00000033554432, wp 00000369098752, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00012: swr, ofst 00000402653184, len 00000033554432, cap 00000033554432, wp 00000402653184, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00013: swr, ofst 00000436207616, len 00000033554432, cap 00000033554432, wp 00000436207616, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00014: swr, ofst 00000469762048, len 00000033554432, cap 00000033554432, wp 00000469762048, em, non_seq 0, reset 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zone 00015: swr, ofst 00000503316480, len 00000033554432, cap 00000033554432, wp 00000503316480, em, non_seq 0, reset 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Other possible zone operations are <em>close</em>, <em>reset</em> and <em>finish</em>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="graphical-interface"></a>Graphical Interface<a class="hash-link" href="#graphical-interface" title="Direct link to heading">#</a></h3><p><em>gzbd</em> provides a graphical user interface showing the zone configuration and
state of a zoned block device. <em>gzbd</em> also  displays  the  write status (write
pointer position) of zones graphically using color coding (red for written
sectors and green for unwritten sectors). Operations on zones can also be
executed directly from the interface (reset zone write pointer, open zone,
close zone, etc).</p><div class="container text--center"><figure><img src="/assets/images/tools-libzbd-gzbd-3a358277b4b4b8a9ea5629ce574afad4.png" width="640" max-width="100%"><figcaption><em>gzbd screenshot</em></figcaption></figure></div><p>The <em>gzbd-viewer</em> graphical interface is a simpler tool than <em>gzbd</em> that only
allows displaying the current zone condition and state of a zoned block device.
The zone state is refreshed by defaul twice per second. This period can be
adjusted using a command line option.</p><div class="container text--center"><figure><img src="/assets/images/tools-libzbd-gzbd-viewer-63527beb07ac767d890a1b9616c85add.png" width="640" max-width="100%"><figcaption><em>gzbd-viewer screenshot</em></figcaption></figure></div><p>Using <em>gzbd</em> enables simple visual cues as to how an application is performaing
and using the zones of a zoned block device. The following example illustrates
this.</p><div class="container text--center"><figure><video controls="" width="640" max-width="100%"><source type="video/mp4" src="/assets/medias/tools-libzbd-gzbd-viewer-example-b3b4ef97af02e55f8b536f5b1b3c32d0.mp4"></video><figcaption><em>Application execution observed with gzbd-viewer</em></figcaption></figure></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tools/libzbc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« libzbc User Library</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tools/libnvme"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">libnvme User Library Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#library-functions" class="table-of-contents__link">Library Functions</a></li><li><a href="#utilities" class="table-of-contents__link">Utilities</a><ul><li><a href="#zbd-tool-examples" class="table-of-contents__link"><em>zbd</em> Tool Examples</a></li><li><a href="#zone-operations" class="table-of-contents__link">Zone Operations</a></li><li><a href="#graphical-interface" class="table-of-contents__link">Graphical Interface</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting Started with Zoned Storage</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix</a></li><li class="footer__item"><a href="https://join.slack.com/t/zonedstorage/shared_invite/zt-uyfut5xe-nKajp9YRnEWqiD4X6RkTFw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://webchat.oftc.net/?channels=zonedstorage" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC @ OFTC</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.18692684.js"></script>
<script src="/assets/js/main.e827f9a4.js"></script>
</body>
</html>