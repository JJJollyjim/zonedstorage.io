<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Zoned Storage Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Zoned Storage Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><title data-react-helmet="true">Linux Tools for ZNS | Zoned Storage</title><meta data-react-helmet="true" property="og:url" content="https://zonedstorage.io/docs/tools/zns"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Linux Tools for ZNS | Zoned Storage"><meta data-react-helmet="true" name="description" content="Zoned namespace support was added to the Linux kernel with version 5.9. The"><meta data-react-helmet="true" property="og:description" content="Zoned namespace support was added to the Linux kernel with version 5.9. The"><link data-react-helmet="true" rel="shortcut icon" href="/img/zs-logo.ico"><link data-react-helmet="true" rel="canonical" href="https://zonedstorage.io/docs/tools/zns"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/tools/zns" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/tools/zns" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c9b2f887.css">
<link rel="preload" href="/assets/js/runtime~main.989ef241.js" as="script">
<link rel="preload" href="/assets/js/main.9f0435fb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/community/support">Community</a></li><li class="menu__list-item"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zoned-storage">Zoned Storage Devices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/smr">Shingled Magnetic Recording</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zns">NVMe Zoned Namespaces (ZNS) SSDs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/prerequisites">System Prerequisites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/nullblk">Zoned Block Device Emulation with nullblk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-disk">Getting Started with SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-emulation">Getting Started with Emulated SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/zns-emulation">Getting Started with Emulated NVMe ZNS Devices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Linux Kernel Support</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/overview">Linux Kernel Zoned Storage Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/config">Kernel Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/zbd-api">Zoned Block Device User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/sched">Write Ordering Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/part">Zoned Block Device Partition Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/dm">Device Mapper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linux/fs">File Systems</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications">Applications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/zenfs">RocksDB with ZenFS</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tools and Libraries</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/util-linux">Linux System Utilities</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tools/zns">ZNS Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/sg3utils">SCSI Generic Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/libzbc">libzbc User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/libzbd">libzbd User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/libnvme">libnvme User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/tcmu-runner">tcmu-runner ZBC Disk Emulation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools/qemu">QEMU and KVM</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">System Compliance Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/zbc-tests">ZBC/ZAC Compliance Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/blktests">Kernel Block Layer Tests</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/distributions/linux">Linux Distributions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/benchmarking/benchmark">Benchmarking Zoned Block Device</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq/faq">Frequently Asked Questions</a></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">ZNS Tools</h1></header><div class="markdown"><p>Zoned namespace support was added to the Linux kernel with version 5.9. The
initial driver release requires the namespace implement the Zone Append command
in order to use with the kernel&#x27;s block stack.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="nvme-cli"></a>nvme-cli<a class="hash-link" href="#nvme-cli" title="Direct link to heading">#</a></h2><p>Open source tooling for zns is provided
by <a href="https://github.com/linux-nvme/nvme-cli" target="_blank" rel="noopener noreferrer">nvme-cli</a>
in the current master branch starting from version 1.12 and onward. It is
recommended to use the latest version, which is currently at version 1.13.</p><p>The ZNS specific commands all use the <em>zns</em> command line prefix. You can view
further available commands by checking its help:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns help</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nvme-1.12</span></div><div class="token-line" style="color:#393A34"><span class="token plain">usage: nvme zns &lt;command&gt; [&lt;device&gt;] [&lt;args&gt;]</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">The &#x27;&lt;device&gt;&#x27; may be either an NVMe character device (ex: /dev/nvme0) or an</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nvme block device (ex: /dev/nvme0n1).</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Zoned Namespace Command Set</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">The following are all implemented sub-commands:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  id-ctrl             Retrieve ZNS controller identification</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  id-ns               Retrieve ZNS namespace identification</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  zone-mgmt-recv      Sends the zone management receive command</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  zone-mgmt-send      Sends the zone management send command</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  report-zones        Retrieve the Report Zones report</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  close-zone          Closes one or more zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  finish-zone         Finishes one or more zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  open-zone           Opens one or more zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  reset-zone          Resets one or more zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  offline-zone        Offlines one or more zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  set-zone-desc       Attaches zone descriptor extension data</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  zone-append         Writes data and metadata (if applicable), appended to the end of the requested zone</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  changed-zone-list   Retrieves the changed zone list log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="identify-zns-controller"></a>Identify ZNS Controller<a class="hash-link" href="#identify-zns-controller" title="Direct link to heading">#</a></h3><p>The Zoned Namespace Command Set specification currently defines only one field
in the command set&#x27;s Identify Controller: the Zone Append Size Limit (ZASL),
encoding the maximum command size for a Zone Append command. The example below
returns &#x27;5&#x27;, which corresponds to 128k bytes for maximum append:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns id-ctrl /dev/nvme1n1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">NVMe ZNS Identify Controller:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zasl    : 5</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="identify-zns-namespace"></a>Identify ZNS Namespace<a class="hash-link" href="#identify-zns-namespace" title="Direct link to heading">#</a></h3><p>Information specific to a Zoned Namespace can be found in this command set&#x27;s
Identify Namespace.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns id-ns /dev/nvme1n1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ZNS Command Set Identify Namespace:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zoc     : 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ozcs    : 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mar     : 0xffffffff</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mor     : 0xffffffff</span></div><div class="token-line" style="color:#393A34"><span class="token plain">rrl     : 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">frl     : 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">lbafe  0: zsze:0x100000 zdes:0 (in use)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>More detailed information can be found with the &#x27;-H&#x27; (human readable) option:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns id-ns /dev/nvme1n1  -H</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ZNS Command Set Identify Namespace:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zoc     : 0   Zone Operation Characteristics</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  [1:1] : 0     Zone Active Excursions: No</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  [0:0] : 0     Variable Zone Capacity: No</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ozcs    : 1   Optional Zoned Command Support</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  [2:2] : 0x1   Read Across Zone Boundaries: Yes</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mar     : 0xffffffff</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mor     : 0xffffffff</span></div><div class="token-line" style="color:#393A34"><span class="token plain">rrl     : Not Reported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">frl     : Not Reported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">LBA Format Extension  0 : Zone Size: 0x100000 LBAs - Zone Descriptor Extension Size: 0 bytes (in use)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>If the output is intended to be processed by another script, a more computer
friendly json format can be requested with the &#x27;-o json&#x27; option:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns id-ns /dev/nvme1n1  -o json</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;zoc&quot; : 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;ozcs&quot; : 1,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;mar&quot; : 4294967295,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;mor&quot; : 4294967295,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;rrl&quot; : 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;frl&quot; : 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;lbafe&quot; : [</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &quot;zsze&quot; : 1048576,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &quot;zdes&quot; : 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  ]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="reporting-zones"></a>Reporting Zones<a class="hash-link" href="#reporting-zones" title="Direct link to heading">#</a></h3><p>The &#x27;report-zones&#x27; command can get information on individual zones, including
their current zone state and write pointer. The following example retreives the
first 10 zone descriptors.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0x2000     Cap: 0x100000   State: IMP_OPENED   Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x200000   WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x300000   WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x400000   WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x500000   WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x600000   WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x700000   WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x800000   WP: 0x8c1000   Cap: 0x100000   State: IMP_OPENED   Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x900000   WP: 0x900000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="resetting-a-zone"></a>Resetting a Zone<a class="hash-link" href="#resetting-a-zone" title="Direct link to heading">#</a></h3><p>To reset the write pointer and return a zone to the EMPTY state, the
&#x27;zone-reset&#x27; command can be used. The following example resets all zones with
the &#x27;-a&#x27; option (WARNING: this effectively deletes the zone&#x27;s data).</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns reset-zone /dev/nvme1n1 -a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zns-reset-zone: Success, action:4 zone:0 nsid:1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The &#x27;report-zones&#x27; will now show all the zones are reset to the empty state:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0x0        Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x200000   WP: 0x200000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x300000   WP: 0x300000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x400000   WP: 0x400000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x500000   WP: 0x500000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x600000   WP: 0x600000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x700000   WP: 0x700000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x800000   WP: 0x800000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x900000   WP: 0x900000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="opening-a-zone"></a>Opening a Zone<a class="hash-link" href="#opening-a-zone" title="Direct link to heading">#</a></h3><p>Explicitly opening a zone will make it ready for immediate write access and
consumes an Open Resource. Opening the first zone:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns open-zone /dev/nvme1n1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zns-open-zone: Success, action:3 zone:0 nsid:1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Verifying its current state:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0x0        Cap: 0x100000   State: EXP_OPENED   Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="closing-a-zone"></a>Closing a Zone<a class="hash-link" href="#closing-a-zone" title="Direct link to heading">#</a></h3><p>Closing the zone releases the open resource and can be done on either
explicitly or implicitly open zones. Closing the first zone:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns close-zone /dev/nvme1n1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zns-close-zone: Success, action:1 zone:0 nsid:1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Verifying its current state:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0x0        Cap: 0x100000   State: CLOSED       Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="finishing-a-zone"></a>Finishing a Zone<a class="hash-link" href="#finishing-a-zone" title="Direct link to heading">#</a></h3><p>Finishing a zone sets its state to &#x27;full&#x27;. Finishing the first zone:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns finish-zone /dev/nvme1n1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zns-finish-zone: Success, action:2 zone:0 nsid:1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Verifying its current state:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0xffffffffffffffff Cap: 0x100000   State: FULL         Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="offlining-a-zone"></a>Offlining a Zone<a class="hash-link" href="#offlining-a-zone" title="Direct link to heading">#</a></h3><p>Offlining a zone makes the zone inaccessible. The data on the zone will no
longer be accessible, and writes to the zone will not be possible until the
zone is reset. Offlining the first zone:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns offline-zone /dev/nvme1n1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zns-offline-zone: Success, action:5 zone:0 nsid:1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Verifying its current state:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0          Cap: 0x100000   State: OFFLINE      Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zone-append"></a>Zone Append<a class="hash-link" href="#zone-append" title="Direct link to heading">#</a></h3><p>You can append data to specific zones. In this method, you only specify which zone to append data to, and the device will return the LBA where it stored the data. Here are a few examples below.</p><p>Append &quot;hello world&quot; to the first zone block (512 bytes in this example):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># echo &quot;hello world&quot; | nvme zns zone-append /dev/nvme1n1 -z 512</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Success appended data to LBA 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Read the data back from LBA 0 to verify it saved our data:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme read /dev/nvme1n1 -z 512</span></div><div class="token-line" style="color:#393A34"><span class="token plain">hello world</span></div><div class="token-line" style="color:#393A34"><span class="token plain">read: Success</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Now append more data and verify its contents:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># echo &quot;goodbye world&quot; | nvme zns zone-append /dev/nvme1n1 -z 512</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Success appended data to LBA 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># nvme read /dev/nvme1n1 -z 512 -s 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">goodbye world</span></div><div class="token-line" style="color:#393A34"><span class="token plain">read: Success</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Since we&#x27;ve appended two blocks to zone 0, we can check the current report
zones to verify the current write pointer:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># nvme zns report-zones /dev/nvme1n1 -d 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nr_zones: 373</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x0        WP: 0x2        Cap: 0x100000   State: IMP_OPENED   Type: SEQWRITE_REQ   Attrs: 0x0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SLBA: 0x100000   WP: 0x100000   Cap: 0x100000   State: EMPTY        Type: SEQWRITE_REQ   Attrs: 0x0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tools/util-linux"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Linux System Utilities</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tools/sg3utils"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SCSI Generic Utilities Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nvme-cli" class="table-of-contents__link">nvme-cli</a><ul><li><a href="#identify-zns-controller" class="table-of-contents__link">Identify ZNS Controller</a></li><li><a href="#identify-zns-namespace" class="table-of-contents__link">Identify ZNS Namespace</a></li><li><a href="#reporting-zones" class="table-of-contents__link">Reporting Zones</a></li><li><a href="#resetting-a-zone" class="table-of-contents__link">Resetting a Zone</a></li><li><a href="#opening-a-zone" class="table-of-contents__link">Opening a Zone</a></li><li><a href="#closing-a-zone" class="table-of-contents__link">Closing a Zone</a></li><li><a href="#finishing-a-zone" class="table-of-contents__link">Finishing a Zone</a></li><li><a href="#offlining-a-zone" class="table-of-contents__link">Offlining a Zone</a></li><li><a href="#zone-append" class="table-of-contents__link">Zone Append</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/index">Getting Started with Zoned Storage</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix</a></li><li class="footer__item"><a href="https://join.slack.com/t/zonedstorage/shared_invite/zt-uyfut5xe-nKajp9YRnEWqiD4X6RkTFw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://webchat.oftc.net/?channels=zonedstorage" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC @ OFTC</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.989ef241.js"></script>
<script src="/assets/js/main.9f0435fb.js"></script>
</body>
</html>