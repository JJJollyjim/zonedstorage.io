<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Zoned Storage Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Zoned Storage Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><title data-react-helmet="true">Zoned Block Device User Interface | Zoned Storage</title><meta data-react-helmet="true" property="og:url" content="https://zonedstorage.io/docs/linux/zbd-api"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Zoned Block Device User Interface | Zoned Storage"><meta data-react-helmet="true" name="description" content="User applications can access the zone information of a zoned block device and"><meta data-react-helmet="true" property="og:description" content="User applications can access the zone information of a zoned block device and"><link data-react-helmet="true" rel="shortcut icon" href="/img/zs-logo.ico"><link data-react-helmet="true" rel="canonical" href="https://zonedstorage.io/docs/linux/zbd-api"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/linux/zbd-api" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zonedstorage.io/docs/linux/zbd-api" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.30532e53.css">
<link rel="preload" href="/assets/js/runtime~main.18692684.js" as="script">
<link rel="preload" href="/assets/js/main.e827f9a4.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Zoned Storage</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/community/support">Community</a></li><li class="menu__list-item"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zoned-storage">Zoned Storage Devices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/smr">Shingled Magnetic Recording</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/zns">NVMe Zoned Namespaces (ZNS) SSDs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/prerequisites">System Prerequisites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/nullblk">Zoned Block Device Emulation with nullblk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-disk">Getting Started with SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/smr-emulation">Getting Started with Emulated SMR Hard-Disks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/zns-emulation">Getting Started with Emulated NVMe ZNS Devices</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Linux Kernel Support</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/overview">Linux Kernel Zoned Storage Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/config">Kernel Configuration</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/linux/zbd-api">Zoned Block Device User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/sched">Write Ordering Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/part">Zoned Block Device Partition Support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/dm">Device Mapper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/fs">File Systems</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/percona-server">Percona Server for MySQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/applications/zenfs">RocksDB with ZenFS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tools and Libraries</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/util-linux">Linux System Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/zns">ZNS Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/sg3utils">SCSI Generic Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/libzbc">libzbc User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/libzbd">libzbd User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/libnvme">libnvme User Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/tcmu-runner">tcmu-runner ZBC Disk Emulation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools/qemu">QEMU and KVM</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">System Compliance Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/zbc-tests">ZBC/ZAC Compliance Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/blktests">Kernel Block Layer Tests</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/distributions/linux">Linux Distributions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/benchmarking/benchmark">Benchmarking Zoned Block Devices</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq/faq">Frequently Asked Questions</a></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Zoned Block Device User Interface</h1></header><div class="markdown"><p>User applications can access the zone information of a zoned block device and
can manage the zones of a zoned block device by using two types of interfaces.</p><ol><li><p><em>sysfs</em> attribute files, accessible either directly from applications as
regular files or from scripted languages (shell scripts, python, etc).</p></li><li><p><em>ioctl()</em> system calls, suitable for use from C programs or other programming
languages that have an equivalent system-call binding.</p></li></ol><p>The <em>sysfs</em> files and <em>ioctl()</em> commands available to applications have evolved
since the introduction of zoned block device support in Kernel 4.10. The
availability of files and commands per kernel version is detailed in the
following sections.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="sysfs-interface"></a>Sysfs Interface<a class="hash-link" href="#sysfs-interface" title="Direct link to heading">#</a></h2><p>Programs that use scripting languages (e.g. bash scripts) can access zoned
device information through <em>sysfs</em> attribute files. The attribute files provided
are shown in the following table.</p><center><table><thead><tr><th align="left">File</th><th align="left">Kernel version</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">/sys/block/<em>dev name</em>/queue/zoned</td><td align="left">4.10.0</td><td align="left">Device zoned model</td></tr><tr><td align="left">/sys/block/<em>dev name</em>/queue/chunk_sectors</td><td align="left">4.10.0</td><td align="left">Device zone size</td></tr><tr><td align="left">/sys/block/<em>dev name</em>/queue/nr_zones</td><td align="left">4.20.0</td><td align="left">Total number of zones</td></tr><tr><td align="left">/sys/block/<em>dev name</em>/queue/zone_append_max_bytes</td><td align="left">5.8.0</td><td align="left">Maximum size in bytes of a zone append write operation</td></tr><tr><td align="left">/sys/block/<em>dev name</em>/queue/max_open_zones</td><td align="left">5.9.0</td><td align="left">Maximum number of open zones</td></tr><tr><td align="left">/sys/block/<em>dev name</em>/queue/max_active_zones</td><td align="left">5.9.0</td><td align="left">Maximum number of active zones</td></tr></tbody></table></center><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="device-zoned-model"></a>Device Zoned Model<a class="hash-link" href="#device-zoned-model" title="Direct link to heading">#</a></h3><p>The zone model of a zoned device can be discovered by using the <code>zoned</code> device
queue attribute file. For example: for a zoned block device named <em>sdb</em>, the
following shell command displays the device zoned model.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/block/sdb/queue/zoned</span></div><div class="token-line" style="color:#393A34"><span class="token plain">host-managed</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The possible values of the <em>zoned</em> attribute file are shown in the table below.</p><center><table><thead><tr><th align="left">Value</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">none</td><td align="left">Regular block device, including drive-managed SMR disks</td></tr><tr><td align="left">host-aware</td><td align="left">Host-aware device model</td></tr><tr><td align="left">host-managed</td><td align="left">Host-managed device model</td></tr></tbody></table></center><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="device-zone-size"></a>Device Zone Size<a class="hash-link" href="#device-zone-size" title="Direct link to heading">#</a></h3><p>The device zone size can be read from the <em>sysfs</em> queue attribute file that is
named <code>chunk_sectors</code>. For a device named <em>sdb</em> (the same device as in the
previous example), the following command gives the device zone size.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/block/sdb/queue/chunk_sectors</span></div><div class="token-line" style="color:#393A34"><span class="token plain">524288</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The value is displayed as a number of 512B sectors, regardless of the actual
logical and physical block size of the device. In this example, the device zone
size is <em>524288 x 512 = 256 MiB</em>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="number-of-zones"></a>Number of Zones<a class="hash-link" href="#number-of-zones" title="Direct link to heading">#</a></h3><p>The sysfs queue attribute file <em>nr_zones</em> was introduced in Linux kernel version
4.20.0, and is available to obtain the total number of zones of a zoned device.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/block/sdb/queue/nr_zones</span></div><div class="token-line" style="color:#393A34"><span class="token plain">55880</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This attribute value is always 0 for a regular block device.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ioctl-application-programming-interface"></a><em>ioctl()</em> Application Programming Interface<a class="hash-link" href="#ioctl-application-programming-interface" title="Direct link to heading">#</a></h2><p>The C header file <code>/usr/include/linux/blkzoned.h</code> contains macro definitions and
data structure definitions that allow application developers to obtain
information about zoned block devices and to manage the zones of the devices.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zone-information-data-structures"></a>Zone Information Data Structures<a class="hash-link" href="#zone-information-data-structures" title="Direct link to heading">#</a></h3><p>The data structure <code>struct blk_zone</code> defines a zone-descriptor structure that
contains a complete description of a zone: this includes the zone&#x27;s location on
the device, the zone type, its condition (state), and the position of the zone
write pointer (for sequential zones). For kernels Up to kernel version 5.8, this
data structure is as shown below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * struct blk_zone - Zone descriptor for BLKREPORTZONE ioctl.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @start: Zone start in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @len: Zone length in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @wp: Zone write pointer location in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @type: see enum blk_zone_type for possible values</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @cond: see enum blk_zone_cond for possible values</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @non_seq: Flag indicating that the zone is using non-sequential resources</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *           (for host-aware zoned block devices only).</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @reset: Flag indicating that a zone reset is recommended.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @reserved: Padding to 64 B to match the ZBC/ZAC defined zone descriptor size.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * start, len, capacity and wp use the regular 512 B sector unit, regardless</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * of the device logical block size. The overall structure size is 64 B to</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * match the size of the ZBC-, ZAC- and ZNS-defined zone descriptor and to </span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * allow support for future additional zone information.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   start</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">/* Zone start sector */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   len</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">/* Zone length in number of sectors */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   wp</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">/* Zone write pointer position */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">/* Zone type */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    cond</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">/* Zone condition */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    non_seq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">/* Non-sequential write resources active */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    reset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">/* Reset write pointer recommended */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    reserved</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">36</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>As indicated in the comments to this data structure definition, the unit that
is used to indicate (1) the zone start position, (2) the zone&#x27;s size and (3) the
write pointer position is 512B sector size. This holds true regardless of the
actual logical block size of the device. Even for a device with a 4KB logical
sector, the above zone descriptor fields use a 512-byte sector size unit.</p><p>The <em>capacity</em> field was added to <em>struct blk_zone</em> in kernel version 5.9. With
this change, the data structure is as follows.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">/**</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * struct blk_zone - Zone descriptor for BLKREPORTZONE ioctl.</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> *</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @start: Zone start in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @len: Zone length in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @wp: Zone write pointer location in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @type: see enum blk_zone_type for possible values</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @cond: see enum blk_zone_cond for possible values</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @non_seq: Flag indicating that the zone is using non-sequential resources</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> *           (for host-aware zoned block devices only).</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @reset: Flag indicating that a zone reset is recommended.</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @resv: Padding for 8B alignment.</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @capacity: Zone usable capacity in 512 B sector units</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * @reserved: Padding to 64 B to match the ZBC, ZAC and ZNS defined zone</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> *            descriptor size.</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> *</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * start, len, capacity and wp use the regular 512 B sector unit, regardless</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * of the device logical block size. The overall structure size is 64 B to</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * match the ZBC, ZAC and ZNS defined zone descriptor and allow support for</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * future additional zone information.</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">struct blk_zone {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   start;          /* Zone start sector */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   len;            /* Zone length in number of sectors */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   wp;             /* Zone write pointer position */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    type;           /* Zone type */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    cond;           /* Zone condition */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    non_seq;        /* Non-sequential write resources active */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    reset;          /* Reset write pointer recommended */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    resv[4];</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   capacity;       /* Zone capacity in number of sectors */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    reserved[24];</span></div><div class="token-line" style="color:#393A34"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The <em>capacity</em> field indicates the usable zone capacity of a zone in units of
512B sectors. The presence, or validity, of this field within the structure is
indicated using a zone report flag.
See <a href="#obtaining-zone-information"><em>Obtaining Zone Information</em></a> below for
details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zone-type"></a>Zone Type<a class="hash-link" href="#zone-type" title="Direct link to heading">#</a></h3><p>The <code>type</code> field of a zone descriptor can have only one of the values defined by
the enumeration <code>enum blk_zone_type</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * enum blk_zone_type - Types of zones allowed in a zoned device.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_TYPE_CONVENTIONAL: The zone has no write pointer and can be writen</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                              randomly. Zone reset has no effect on the zone.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_TYPE_SEQWRITE_REQ: The zone must be written sequentially</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_TYPE_SEQWRITE_PREF: The zone can be written non-sequentially</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Any other value not defined is reserved and must be considered as invalid.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token class-name">blk_zone_type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_TYPE_CONVENTIONAL      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_TYPE_SEQWRITE_REQ      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_TYPE_SEQWRITE_PREF     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zone-condition"></a>Zone Condition<a class="hash-link" href="#zone-condition" title="Direct link to heading">#</a></h3><p>The <code>cond</code> field of the <code>struct blkzone</code> data structure defines the current
condition of a zone. The possible condition (state) values of this field are
defined by the <code>blk_zone_cond</code> enumeration.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * enum blk_zone_cond - Condition [state] of a zone in a zoned device.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_NOT_WP: The zone has no write pointer, it is conventional.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_EMPTY: The zone is empty.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_IMP_OPEN: The zone is open, but not explicitly opened.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_EXP_OPEN: The zones was explicitly opened by an</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                          OPEN ZONE command.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_CLOSED: The zone was [explicitly] closed after writing.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_FULL: The zone is marked as full, possibly by a zone</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                      FINISH ZONE command.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_READONLY: The zone is read-only.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_COND_OFFLINE: The zone is offline (sectors cannot be read/written).</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * The Zone Condition state machine in the ZBC/ZAC standards maps the above</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * deinitions as:</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC1: Empty         | BLK_ZONE_EMPTY</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC2: Implicit Open | BLK_ZONE_COND_IMP_OPEN</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC3: Explicit Open | BLK_ZONE_COND_EXP_OPEN</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC4: Closed        | BLK_ZONE_CLOSED</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC5: Full          | BLK_ZONE_FULL</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC6: Read Only     | BLK_ZONE_READONLY</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   - ZC7: Offline       | BLK_ZONE_OFFLINE</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Conditions 0x5 to 0xC are reserved by the current ZBC/ZAC spec and should</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * be considered invalid.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token class-name">blk_zone_cond</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_NOT_WP    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_EMPTY     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_IMP_OPEN  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_EXP_OPEN  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_CLOSED    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_READONLY  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_FULL      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_COND_OFFLINE   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xF</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Under a device&#x27;s normal operation, some of these conditions cannot result
directly from host-initiated operations. These conditions are
<code>BLK_ZONE_COND_OFFLINE</code> and <code>BLK_ZONE_COND_READONLY</code>. They can be set only by
the device itself, to indicate zones with capabilities that have been limited by
a hardware defect.</p><p>Transitions to other conditions result from user operations, either write
operations or zone management commands. Zone management commands can be issued
by an application using the kernel <em>ioctl()</em> interface
(see <a href="#ioctl-commands"><em>ioctl()</em> Commands</a>.</p><p>The SCSI Zoned Block Command specification (ZBC), the ATA Zoned Device ATA
Command Set specification (ZAC) and the NVM Express Zoned Namespace Command
Set specification (ZNS) define a zone condition state machine governing the
possible transitions of a zone from one condition to another depending on the
commands executed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ioctl-commands"></a><em>ioctl()</em> Commands<a class="hash-link" href="#ioctl-commands" title="Direct link to heading">#</a></h2><p>Several <em>ioctl()</em> commands are defined to manipulate and obtain information and
manipulate the zones of a zoned block device. All supported commands are shown
below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Zoned block device ioctl&#x27;s:</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKREPORTZONE: Get zone information. Takes a zone report as argument.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                 The zone report will start from the zone containing the</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                 sector specified in the report request structure.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKRESETZONE: Reset the write pointer of the zones in the specified</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                sector range. The sector range must be zone aligned.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKGETZONESZ: Get the device zone size in number of 512 B sectors.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKGETNRZONES: Get the total number of zones of the device.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKOPENZONE: Open the zones in the specified sector range.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *               The 512 B sector range must be zone aligned.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKCLOSEZONE: Close the zones in the specified sector range.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                The 512 B sector range must be zone aligned.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLKFINISHZONE: Mark the zones as full in the specified sector range.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                 The 512 B sector range must be zone aligned.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKREPORTZONE</span><span class="token macro property" style="color:#36acaa">   </span><span class="token macro property expression function" style="color:#d73a49">_IOWR</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">130</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">struct</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression class-name" style="color:#36acaa">blk_zone_report</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKRESETZONE</span><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression function" style="color:#d73a49">_IOW</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">131</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">struct</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression class-name" style="color:#36acaa">blk_zone_range</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKGETZONESZ</span><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression function" style="color:#d73a49">_IOR</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">132</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> __u32</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKGETNRZONES</span><span class="token macro property" style="color:#36acaa">   </span><span class="token macro property expression function" style="color:#d73a49">_IOR</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">133</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> __u32</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKOPENZONE</span><span class="token macro property" style="color:#36acaa">     </span><span class="token macro property expression function" style="color:#d73a49">_IOW</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">134</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">struct</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression class-name" style="color:#36acaa">blk_zone_range</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKCLOSEZONE</span><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression function" style="color:#d73a49">_IOW</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">135</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">struct</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression class-name" style="color:#36acaa">blk_zone_range</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">BLKFINISHZONE</span><span class="token macro property" style="color:#36acaa">   </span><span class="token macro property expression function" style="color:#d73a49">_IOW</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression number" style="color:#36acaa">0x12</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">136</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">struct</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression class-name" style="color:#36acaa">blk_zone_range</span><span class="token macro property expression punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Not all commands are available on all kernel versions. The following table shows
the kernel version that introduced each command.</p><center><table><thead><tr><th align="left">Command</th><th align="left">Kernel version</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">BLKREPORTZONE</td><td align="left">4.10.0</td><td align="left">Get zone information</td></tr><tr><td align="left">BLKRESETZONE</td><td align="left">4.10.0</td><td align="left">Reset a zone write pointer</td></tr><tr><td align="left">BLKGETZONESZ</td><td align="left">4.20.0</td><td align="left">Get a device zone size</td></tr><tr><td align="left">BLKGETNRZONES</td><td align="left">4.20.0</td><td align="left">Get the total number of zones of a device</td></tr><tr><td align="left">BLKOPENZONE</td><td align="left">5.5.0</td><td align="left">Explicitly open a zone</td></tr><tr><td align="left">BLKCLOSEZONE</td><td align="left">5.5.0</td><td align="left">Close a zone</td></tr><tr><td align="left">BLKFINISHZONE</td><td align="left">5.5.0</td><td align="left">Finish a zone</td></tr></tbody></table></center><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="obtaining-zone-information"></a>Obtaining Zone Information<a class="hash-link" href="#obtaining-zone-information" title="Direct link to heading">#</a></h3><p>The <em>BLKREPORTZONE</em> command allows an application to obtain a device&#x27;s zone
information in the form of an array of zone descriptors. The data argument
that is passed to the <code>ioctl()</code> must be the address of a memory area large
enough to store one <code>struct blk_zone_report</code> header structure, followed by an
array of zone descriptors.</p><p>The zone report header structure <code>blk_zone_report</code> is as shown below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * struct blk_zone_report - BLKREPORTZONE ioctl request/reply</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @sector: starting sector of report</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @nr_zones: IN maximum / OUT actual</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @reserved: padding to 16 byte alignment</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @zones: Space to hold @nr_zones @zones entries on reply.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * The array of at most @nr_zones must follow this structure in memory.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone_report</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    __u64       sector</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    __u32       nr_zones</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    __u8        reserved</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone</span><span class="token plain"> zones</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The header indicates the 512-byte sector from which the report should start as
well as  the number of zone descriptors in the array following the header. A
typical use of the <code>BLKREPORTZONE</code> command to obtain information on all the
zones of a device is as shown below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/blkzoned.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> start_sector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone_report</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">hdr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">size_t</span><span class="token plain"> hdr_len</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> nr_zones </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">hdr_len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone_report</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> nr_zones </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blkzone</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">hdr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">malloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hdr_len</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">hdr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">sector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> start_sector</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">nr_zones </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nr_zones</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BLKREPORTZONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hdr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">nr_zones</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">/* Done */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Got %u zone descriptors\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">nr_zones</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* The next report must start after the last zone reported */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    start_sector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">zones</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">nr_zones </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">               hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">zones</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">hdr</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">nr_zones </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">len</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The number of zone descriptors obtained is returned to the user in the
<code>nr_zones</code> field of the report header structure <code>blk_zone_report</code>.</p><p>With the introduction of zone capacity support for NVMe Zoned Namepsaces in
kernel version 5.9, zone descriptors gained the <code>capacity</code> field. The presence
of this field is indicated by the new <code>flag</code> field added to
<code>struct blk_zone_report</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * enum blk_zone_report_flags - Feature flags of reported zone descriptors.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @BLK_ZONE_REP_CAPACITY: Zone descriptor has capacity field.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token class-name">blk_zone_report_flags</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        BLK_ZONE_REP_CAPACITY   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * struct blk_zone_report - BLKREPORTZONE ioctl request/reply</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @sector: starting sector of report</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @nr_zones: IN maximum / OUT actual</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @flags: one or more flags as defined by enum blk_zone_report_flags.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @zones: Space to hold @nr_zones @zones entries on reply.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * The array of at most @nr_zones must follow this structure in memory.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone_report</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    __u64       sector</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    __u32       nr_zones</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    __u32       flags</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone</span><span class="token plain"> zones</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>If the <code>flags</code> field of <code>struct blk_zone_report</code> has the flag
<code>BLK_ZONE_REP_CAPACITY</code> set, then the zone descriptor&#x27;s structure will have a
valid value set in the <code>capacity</code> field of <code>sturct blk_zone</code>. Otherwise, this
field can be ignored as it will show a value of 0.</p><p>The example code below, extracted from the code of the
<a href="/docs/tools/libzbd"><em>libzbd</em></a> library, illustrates how applications can
implement backward-compatible support for zone capacity information by using the
autotools build environment.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># less configure.ac</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">AC_CHECK_HEADER(linux/blkzoned.h, [],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                [AC_MSG_ERROR([Couldn&#x27;t find linux/blkzoned.h. Kernel too old ?])],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                [[#include &lt;linux/blkzoned.h&gt;]])</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">AC_CHECK_MEMBER([struct blk_zone.capacity],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                [AC_DEFINE(HAVE_BLK_ZONE_REP_V2, [1], [report zones includes zone capacity])],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                [], [[#include &lt;linux/blkzoned.h&gt;]])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># less lib/zbd.h</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">/*</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> * Handle kernel zone capacity support</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#ifndef HAVE_BLK_ZONE_REP_V2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#define BLK_ZONE_REP_CAPACITY   (1 &lt;&lt; 0)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">struct blk_zone_v2 {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   start;          /* Zone start sector */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   len;            /* Zone length in number of sectors */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   wp;             /* Zone write pointer position */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    type;           /* Zone type */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    cond;           /* Zone condition */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    non_seq;        /* Non-sequential write resources active */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    reset;          /* Reset write pointer recommended */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    resv[4];</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   capacity;       /* Zone capacity in number of sectors */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u8    reserved[24];</span></div><div class="token-line" style="color:#393A34"><span class="token plain">};</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#define blk_zone blk_zone_v2</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">struct blk_zone_report_v2 {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64   sector;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u32   nr_zones;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u32   flags;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">struct blk_zone zones[0];</span></div><div class="token-line" style="color:#393A34"><span class="token plain">};</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#define blk_zone_report blk_zone_report_v2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#endif /* HAVE_BLK_ZONE_REP_V2 */</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>With this method, the main code responsible for issuing and parsing zone reports
always has access to the <code>capacity</code> field of <code>struct blk_zone</code> regardless of
the kernel version the code is executed on. For kernels before kernel version
5.9, the zone capacity field will always be equal to 0, meaning that the zone
capacity should be ignored and that the zone size should be used in its place.
Different coding techniques can also be used to always return a zone capacity
equal to the zone size for kernels lacking support for this field.</p><p>The command line utility <a href="/docs/tools/util-linux#blkzone"><code>blkzone</code></a>, which
is part of the <em>util-linux</em> project, uses the <em>BLKREPORTZONE</em> command to
implement its <em>report</em> function. Its code was modified similarly to the above
method to allow its correct compilation and execution regardless of the version
of the kernel being used.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="resetting-a-zone-write-pointer"></a>Resetting a Zone Write Pointer<a class="hash-link" href="#resetting-a-zone-write-pointer" title="Direct link to heading">#</a></h3><p>The write pointer of a single sequential zone or of a range of contiguous
sequential zones can be reset using the <code>BLKRESETZONE</code> command. Resetting a
sequential zone write pointer position will also transition the zone to the
<em>Empty</em> condition (<code>BLK_ZONE_COND_EMPTY</code>).</p><p>The range of zones to reset is defined using the data structure <code>blk_zone_range</code>
shown below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * struct blk_zone_range - BLKRESETZONE/BLKOPENZONE/</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                         BLKCLOSEZONE/BLKFINISHZONE ioctl</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                         requests</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @sector: Starting sector of the first zone to operate on.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @nr_sectors: Total number of sectors of all zones to operate on.</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone_range</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64           sector</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        __u64           nr_sectors</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The <code>sector</code> field must specify the start sector of the first zone to reset. The
<code>nr_sectors</code> field specifies the total length of the range of zones to reset.
This length must be at least as large as one zone.</p><p>As indicated in comments describing the <code>blk_zone_range</code> structure, the commands
<code>BLKOPENZONE</code>, <code>BLKCLOSEZONE</code> and <code>BLKFINISHZONE</code> also use this data structure
to define the range of zones on which the command will operate.</p><p>The following code shows an example use of the <code>BLKRESETZONE</code> command to reset a
single zone starting at sector 274726912 with a zone size of 256 MiB (524288
sectors of 512B).</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/blkzoned.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">blk_zone_range</span><span class="token plain"> zrange</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">zrange</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">274726912</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">zrange</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nr_sectors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">524288</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BLKRESETZONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">zrange</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The device file descriptor <code>fd</code> must be open for writing in order for this
command to succeed.</p><p>The  command line utility <a href="/docs/tools/util-linux#blkzone"><code>blkzone</code></a> uses
the <em>BLKRESETZONE</em> command to implement its <em>reset</em> functionality.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="opening-closing-and-finishing-zones"></a>Opening, Closing and Finishing Zones<a class="hash-link" href="#opening-closing-and-finishing-zones" title="Direct link to heading">#</a></h3><p>Explicitly opening a zone or a range of zones can be done using the
<em>BLKOPENZONE</em> command. This command uses the same arguments as the
<em>BLKRESETZONE</em> command. It takes a pointer to a data structure <code>blk_zone_range</code>,
which specifies the range of zones to operate on.</p><p>Closing a zone is done using the command <em>BLKCLOSEZONE</em>. Finishing a zone--that
is, transitioning the zone to the <em>full</em> condition (<code>BLK_ZONE_COND_FULL</code>), is
done using the <em>BLKFINISHZONE</em> command. Both of these commands also take as
arguments a pointer to the <code>blk_zone_range</code> data structure to specify the range
of zones to operate on.</p><p>The <em>BLKOPENZONE</em>, <em>BLKCLOSEZONE</em> and <em>BLKFINISHZONE</em> commands were introduced
in kernel version 5.5.0.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="zone-size-and-number-of-zones"></a>Zone Size and Number of Zones<a class="hash-link" href="#zone-size-and-number-of-zones" title="Direct link to heading">#</a></h3><p>LinuxÂ® kernel version 4.20 introduced two new commands: one to obtain
a zoned device&#x27;s zone size (<code>BLKGETZONESZ</code>), and one to obtain the total number
of zones of the device (<code>BLKGETNRZONES</code>). Both commands take a pointer to an
unsigned 32-bit integer variable as an argument, and the zone-size value or the
number of zones will be returned. The following sample C code illustrates the
use of these commands.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI c"><div tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/blkzoned.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> nr_zones</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> zone_size</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">BLKGETZONESZ</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">zone_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">BLKGETNRZONES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">nr_zones</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Device has %u zones of %u 512-Bytes sectors\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">       nr_zones</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> zone_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The command <code>BLKGETNRZONES</code> is especially useful for allocating an array of zone
descriptors large enough for a zone report on all the zones of a device.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/linux/config"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Kernel Configuration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/linux/sched"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Write Ordering Control Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sysfs-interface" class="table-of-contents__link">Sysfs Interface</a><ul><li><a href="#device-zoned-model" class="table-of-contents__link">Device Zoned Model</a></li><li><a href="#device-zone-size" class="table-of-contents__link">Device Zone Size</a></li><li><a href="#number-of-zones" class="table-of-contents__link">Number of Zones</a></li></ul></li><li><a href="#ioctl-application-programming-interface" class="table-of-contents__link"><em>ioctl()</em> Application Programming Interface</a><ul><li><a href="#zone-information-data-structures" class="table-of-contents__link">Zone Information Data Structures</a></li><li><a href="#zone-type" class="table-of-contents__link">Zone Type</a></li><li><a href="#zone-condition" class="table-of-contents__link">Zone Condition</a></li></ul></li><li><a href="#ioctl-commands" class="table-of-contents__link"><em>ioctl()</em> Commands</a><ul><li><a href="#obtaining-zone-information" class="table-of-contents__link">Obtaining Zone Information</a></li><li><a href="#resetting-a-zone-write-pointer" class="table-of-contents__link">Resetting a Zone Write Pointer</a></li><li><a href="#opening-closing-and-finishing-zones" class="table-of-contents__link">Opening, Closing and Finishing Zones</a></li><li><a href="#zone-size-and-number-of-zones" class="table-of-contents__link">Zone Size and Number of Zones</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting Started with Zoned Storage</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix</a></li><li class="footer__item"><a href="https://join.slack.com/t/zonedstorage/shared_invite/zt-uyfut5xe-nKajp9YRnEWqiD4X6RkTFw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://webchat.oftc.net/?channels=zonedstorage" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC @ OFTC</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.18692684.js"></script>
<script src="/assets/js/main.e827f9a4.js"></script>
</body>
</html>