<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Linux Zoned Storage Documentation">
    
    <link rel="canonical" href="https://westerndigitalcorporation.github.io/zonedstorage.io/projects/libzbd/">
    <link rel="shortcut icon" href="../../img/favicon.ico">

    
    <title>libzbd User Library - Zoned Storage</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D23L5EBB2E"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-D23L5EBB2E');
    </script>
    

     
</head>

<body style="padding-top:90px" >

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../..">Zoned Storage</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../community/">Community</a>
                    </li>
                
                
                
                    <li class="dropdown active" style="min-height:60;">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  
  
  
  <li class="dropdown-submenu">
    <a tabindex="-1" href="/introduction/">Introduction</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../introduction/zoned-storage/">Zoned Storage Overview</a>
</li>

        
            
<li >
    <a href="../../introduction/smr/">Shingled Magnetic Recording (SMR) HDDs</a>
</li>

        
            
<li >
    <a href="../../introduction/zns/">Zoned Namespace (ZNS) SSDs</a>
</li>

        
    </ul>
  </li>

                        
                            
  
  
  
  <li class="dropdown-submenu">
    <a tabindex="-1" href="/getting-started/">Getting Started</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../getting-started/prerequisite/">System Prerequisite</a>
</li>

        
            
<li >
    <a href="../../getting-started/nullblk/">Getting Started with an Emulated Zoned Block Device</a>
</li>

        
            
<li >
    <a href="../../getting-started/smr-disk/">Getting Started With SMR Disks</a>
</li>

        
            
<li >
    <a href="../../getting-started/smr-emulation/">Getting Started With Emulated SMR Disks</a>
</li>

        
            
<li >
    <a href="../../getting-started/zns-emulation/">Getting Started With Emulated NVMe ZNS Devices</a>
</li>

        
    </ul>
  </li>

                        
                            
  
  
  
  <li class="dropdown-submenu">
    <a tabindex="-1" href="/linux/">Linux Kernel Support</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../linux/overview/">Support Overview</a>
</li>

        
            
<li >
    <a href="../../linux/config/">Kernel Configuration</a>
</li>

        
            
<li >
    <a href="../../linux/zbd-api/">User Interface</a>
</li>

        
            
<li >
    <a href="../../linux/sched/">Write Command Ordering</a>
</li>

        
            
<li >
    <a href="../../linux/part/">Zoned Block Device Partition Support</a>
</li>

        
            
<li >
    <a href="../../linux/dm/">Device Mapper</a>
</li>

        
            
<li >
    <a href="../../linux/fs/">File Systems</a>
</li>

        
    </ul>
  </li>

                        
                            
  
  
  
  <li class="dropdown-submenu active">
    <a tabindex="-1" href="/projects/">Applications and Libraries</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../util-linux/">Linux System Utilities</a>
</li>

        
            
<li >
    <a href="../sg3utils/">SCSI Generic Utilities</a>
</li>

        
            
<li >
    <a href="../libzbc/">libzbc User Library</a>
</li>

        
            
<li >
    <a href="../libnvme/">libnvme User Library</a>
</li>

        
            
<li class="active">
    <a href="./">libzbd User Library</a>
</li>

        
            
<li >
    <a href="../tcmu-runner/">tcmu-runner ZBC Disk Emulation</a>
</li>

        
            
<li >
    <a href="../qemu/">QEMU and KVM</a>
</li>

        
            
<li >
    <a href="../zns/">Linux Tools for ZNS</a>
</li>

        
    </ul>
  </li>

                        
                            
  
  
  
  <li class="dropdown-submenu">
    <a tabindex="-1" href="/tests/">System Compliance Tests</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../tests/zbc-tests/">ZBC/ZAC Compliance Tests</a>
</li>

        
            
<li >
    <a href="../../tests/blktests/">Kernel Block Layer Tests</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../../distributions/linux/">Linux Distributions</a>
</li>

                        
                            
<li >
    <a href="../../benchmarking/fio/">Benchmarking</a>
</li>

                        
                            
<li >
    <a href="../../faq/faq/">Frequently Asked Questions</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../about/">About</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../libnvme/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../tcmu-runner/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="ssh://git@github.com:westerndigitalcorporation/zonedstorage.io.git">Git@Github</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    
    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
  <h5 style="text-align:center"><b>Table of contents</b></h5>
  <ul class="nav bs-sidenav">

  

    

      

        
        
        
          <li class="first-level"><a href="../../introduction">Introduction</a></li>
          
        

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

      

    

      

        
        
        
          <li class="first-level"><a href="../../getting-started">Getting Started</a></li>
          
        

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

      

    

      

        
        
        
          <li class="first-level"><a href="../../linux">Linux Kernel Support</a></li>
          
        

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

  	  

  	  

        

      

    

      

        
        
        
          <li class="first-level active"><a href="/projects/" style="font-weight:bold">Applications and Libraries</a></li>
          
        

        

  	  
            <li class="second-level"><a href="../util-linux/">Linux System Utilities</a></li>
          

  	  

        

  	  
            <li class="second-level"><a href="../sg3utils/">SCSI Generic Utilities</a></li>
          

  	  

        

  	  
            <li class="second-level"><a href="../libzbc/">libzbc User Library</a></li>
          

  	  

        

  	  
            <li class="second-level"><a href="../libnvme/">libnvme User Library</a></li>
          

  	  

        

  	  

  	  
            
              <li class="second-level active"><a href="#libzbd-user-library">libzbd User Library</a></li>
              
                <li class="third-level"><a href="#overview">Overview</a></li>
                
              
                <li class="third-level"><a href="#library-functions">Library Functions</a></li>
                
              
                <li class="third-level"><a href="#utilities">Utilities</a></li>
                
                  <li class="fourth-level"><a href="#zbd-tool-examples">zbd Tool Examples</a></li>
                
                  <li class="fourth-level"><a href="#zone-operations">Zone Operations</a></li>
                
                  <li class="fourth-level"><a href="#graphical-interface">Graphical Interface</a></li>
                
              
            
          

        

  	  
            <li class="second-level"><a href="../tcmu-runner/">tcmu-runner ZBC Disk Emulation</a></li>
          

  	  

        

  	  
            <li class="second-level"><a href="../qemu/">QEMU and KVM</a></li>
          

  	  

        

  	  
            <li class="second-level"><a href="../zns/">Linux Tools for ZNS</a></li>
          

  	  

        

      

    

      

        
        
        
          <li class="first-level"><a href="../../tests">System Compliance Tests</a></li>
          
        

        

  	  

  	  

        

  	  

  	  

        

      

    

      

        <li class="first-level"><a href="../../distributions/linux/">Linux Distributions</a></li>

      

    

      

        <li class="first-level"><a href="../../benchmarking/fio/">Benchmarking</a></li>

      

    

      

        <li class="first-level"><a href="../../faq/faq/">Frequently Asked Questions</a></li>

      

    

  

  </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="libzbd-user-library">libzbd User Library</h1>
<p><em>libzbd</em> is a user library providing functions for manipulating zoned block
devices.</p>
<p>Unlike the <a href="../libzbc/"><em>libzbc</em></a> library, <em>libzbd</em> does not implement direct
command access to zoned block devices. Rather, <em>libzbd</em> uses the kernel provided
zoned block device interface based on the <em>ioctl()</em> system call. A direct
consequence of this is that <em>libzbd</em> will only allow access to zoned block
devices supported by the kernel running. This includes both physical devices
such as hard-disks supporting the ZBC and ZAC standards, as well as all logical
block devices implemented by various device drivers such as
<a href="/getting-started/nullblk"><em>null_blk</em></a> and <a href="/linux/dm">device mapper</a> drivers.</p>
<p>The <em>libzbd</em> project is hosted on
<a href="https://github.com/westerndigitalcorporation/libzbd"
target="_blank">GitHub</a>. The project
<a href="https://github.com/westerndigitalcorporation/libzbd/blob/master/README.md"
target="_blank"><em>README</em> file</a> provides information on how to compile and 
install <em>libzbd</em> library and its tools.</p>
<h2 id="overview">Overview</h2>
<p><em>libzbd</em> provides functions for discovering and managing the state of zones of
zoned block devices. Read and write accesses to the devices can be done using
standard standard I/O system calls.</p>
<p>The execution of <em>libzbd</em> functions as well as of write operations to zones of a
device may result in changes to the condition or attributes of the device zones
(such as write pointer location in sequential zones). These changes are not
internally tracked by <em>libzbd</em>. In other words, <em>libzbd</em> is stateless. It is the
responsibility of applications to implement tracking of the changes to zones
conditions such as the increasing write pointer position of a sequential zone
after the completion of a write request to the zone.</p>
<h2 id="library-functions">Library Functions</h2>
<p>All <em>libzbd</em> functions use bytes unit for zones information such as the zone
start position on the device, a zone size or the zone write pointer location.
Zoned block devices are identified using regular file descriptor numbers that
can be used as is with standard I/O system calls.</p>
<p>However, application programmers must be careful to always implement read
accesses aligned to the device logical block size. Furthermore, on host managed
zoned block devices, write operations to sequential zones must be aligned
to the device physical block size.</p>
<p>The main functions provided by <em>libzbd</em> are as follows.</p>
<p><center></p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>zbd_open()</td>
<td>Open a zoned block device</td>
</tr>
<tr>
<td>zbd_close()</td>
<td>Close an open zoned block device</td>
</tr>
<tr>
<td>zbd_get_info()</td>
<td>Get a device information</td>
</tr>
<tr>
<td>zbd_report_nr_zones()</td>
<td>Get the number of zones of a device</td>
</tr>
<tr>
<td>zbd_report_zones()<br>zbd_list_zones()</td>
<td>Get a device zone information</td>
</tr>
<tr>
<td>zbd_zones_operation()</td>
<td>Execute an operation on a range of zones</td>
</tr>
<tr>
<td>zbd_open_zones()</td>
<td>Explicitly open a range of zone</td>
</tr>
<tr>
<td>zbd_close_zones()</td>
<td>Close a range of zones</td>
</tr>
<tr>
<td>zbd_reset_zones()</td>
<td>Reset the write pointer of a range of zones</td>
</tr>
<tr>
<td>zbd_finish_zones()</td>
<td>Finish a range of zone</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>More detailed information about these functions usage and behavior can be found
in the comments of
<a href="https://github.com/westerndigitalcorporation/libzbd/blob/master/include/libzbd/zbd.h"
target="_blank"><em>libzbd</em> header file</a>. This header file is by default
installed as <code>/usr/include/libzbd/zbd.h</code>.</p>
<p><em>libzbd</em> does not implement any mutual exclusion mechanism for multi-thread or
multi-process applications. This implies that it is the responsibility of
applications to synchronize the execution of conflicting operations targeting
the same zone. A typical example of such case is concurrent write operations to
the same zone by multiple threads which may result in write errors without
write ordering control by the application.</p>
<p>The following functions are also provided by <em>libzbd</em> to facilitate application
development and tests.</p>
<p><center></p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>zbd_device_is_zoned()</td>
<td>Test if a device is a zoned block device</td>
</tr>
<tr>
<td>zbd_device_model_str()</td>
<td>Get a string description of a device model</td>
</tr>
<tr>
<td>zbd_zone_type_str()</td>
<td>Get a string description of a zone type</td>
</tr>
<tr>
<td>zbd_zone_cond_str()</td>
<td>Get a string description of a zone condition</td>
</tr>
<tr>
<td>zbd_set_log_level()</td>
<td>Set the library verbosity level</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>All functions will behave in the same manner regardless of the type of disk
being used.</p>
<h2 id="utilities">Utilities</h2>
<p><em>libzbd</em> also provides several command line applications to manipulate zoned
block devices by calling the library functions. The list of applications
provided is shown in the table below.</p>
<p><center></p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>zbd</td>
<td>Command line utility to report, open, close, reset and finish zones of a device</td>
</tr>
<tr>
<td>gzbd</td>
<td>Similar to the zbd tool but using a graphical user interface</td>
</tr>
<tr>
<td>gzbd-viewer</td>
<td>Graphical user interface showing the condition and state of zones of a zoned block device</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>All utilities output a help message when executed without any argument.</p>
<pre><code class="language-plaintext"># zbd
Usage: zbd &lt;command&gt; [options] &lt;dev&gt;
Command:
  report    : Get zone information
  reset     : Reset zone(s)
  open      : Explicitly open zone(s)
  close     : Close zone(s)
  finish    : Finish zone(s)
Common options:
  -v           : Verbose mode (for debug)
  -i           : Display device information
  -ofst &lt;ofst (B)&gt; : Start offset of the first zone of the
             target range (default: 0)
  -len &lt;len (B)&gt;   : Size of the zone range to operate on
             (default: device capacity)
  -u &lt;unit (B)&gt;    : Size unit for the ofst and len options
             and for displaying zone report results.
             (default: 1)
Report command options:
  -csv      : Use csv output format
  -n        : Only output the number of zones in the report
  -ro &lt;opt&gt; : Specify zone report filter.
          * &quot;em&quot;: empty zones
          * &quot;oi&quot;: implicitly open zones
          * &quot;oe&quot;: explicitly open zones
          * &quot;cl&quot;: closed zones
          * &quot;fu&quot;: full zones
          * &quot;ro&quot;: read-only zones
          * &quot;ol&quot;: offline zones
          * &quot;nw&quot;: conventional zones
          * &quot;ns&quot;: non-seq write resource zones
          * &quot;rw&quot;: reset-wp recommended zones
</code></pre>
<p>Manual pages are also provided for each tool.</p>
<pre><code class="language-plaintext"># man zbd

ZBD(8)                     System Manager's Manual                       ZBD(8)

NAME
       zbd - manage zoned block devices

SYNOPSIS
       zbd command [options] device

DESCRIPTION
       zbd  is  used  to  manipulate  zones of a zoned block device. Zoned block
       devies are block devices that support the SCSI Zoned Block Commands
       (ZBC), ATA  Zoned-device  ATA  Commands (ZAC)  or  NVMe  Zoned NameSpace
       commands (ZNS).  The zones to operate on can be specified using the
       offset and length options.

       The device argument must be the pathname of the target zoned block
       device.

COMMANDS
   report
       The command zbd report is used to obtain and display the device zone
       information.

       By default, the command will report all zones from the start of the
       device up to the  last zone  of  the  device.  Options may be used to
       modify this behavior, changing the starting zone or the size of the
       report.
...
</code></pre>
<h3 id="zbd-tool-examples"><em>zbd</em> Tool Examples</h3>
<p>The following examples use a null zoned block device with 4 conventional zones
and 12 sequential zones of 32 MB created using the
<a href="/getting-started/nullblk/#creating-a-zoned-null-block-device"><em>nullblk-zoned.sh</em></a>
script.</p>
<pre><code class="language-plaintext"># nullblk-zoned.sh 4096 32 4 12
### Created /dev/nullb0
</code></pre>
<p>The following command can be used to list the zone information for all zones of
a device, including the device information such as logical block size and
capacity.</p>
<pre><code class="language-plaintext"># zbd report -i /dev/nullb0
Device /dev/nullb0:
    Vendor ID: Unknown
    Zone model: host-managed
    Capacity: 0.537 GB (1048576 512-bytes sectors)
    Logical blocks: 131072 blocks of 4096 B
    Physical blocks: 131072 blocks of 4096 B
    Zones: 16 zones of 32.0 MB
    Maximum number of open zones: no limit
    Maximum number of active zones: no limit
Zone 00000: cnv, ofst 00000000000000, len 00000033554432, cap 00000033554432
Zone 00001: cnv, ofst 00000033554432, len 00000033554432, cap 00000033554432
Zone 00002: cnv, ofst 00000067108864, len 00000033554432, cap 00000033554432
Zone 00003: cnv, ofst 00000100663296, len 00000033554432, cap 00000033554432
Zone 00004: swr, ofst 00000134217728, len 00000033554432, cap 00000033554432, wp 00000134217728, em, non_seq 0, reset 0
Zone 00005: swr, ofst 00000167772160, len 00000033554432, cap 00000033554432, wp 00000167772160, em, non_seq 0, reset 0
Zone 00006: swr, ofst 00000201326592, len 00000033554432, cap 00000033554432, wp 00000201326592, em, non_seq 0, reset 0
Zone 00007: swr, ofst 00000234881024, len 00000033554432, cap 00000033554432, wp 00000234881024, em, non_seq 0, reset 0
Zone 00008: swr, ofst 00000268435456, len 00000033554432, cap 00000033554432, wp 00000268435456, em, non_seq 0, reset 0
Zone 00009: swr, ofst 00000301989888, len 00000033554432, cap 00000033554432, wp 00000301989888, em, non_seq 0, reset 0
Zone 00010: swr, ofst 00000335544320, len 00000033554432, cap 00000033554432, wp 00000335544320, em, non_seq 0, reset 0
Zone 00011: swr, ofst 00000369098752, len 00000033554432, cap 00000033554432, wp 00000369098752, em, non_seq 0, reset 0
Zone 00012: swr, ofst 00000402653184, len 00000033554432, cap 00000033554432, wp 00000402653184, em, non_seq 0, reset 0
Zone 00013: swr, ofst 00000436207616, len 00000033554432, cap 00000033554432, wp 00000436207616, em, non_seq 0, reset 0
Zone 00014: swr, ofst 00000469762048, len 00000033554432, cap 00000033554432, wp 00000469762048, em, non_seq 0, reset 0
Zone 00015: swr, ofst 00000503316480, len 00000033554432, cap 00000033554432, wp 00000503316480, em, non_seq 0, reset 0
</code></pre>
<p>The same zone information can also be obtained in csv format to facilitate
parsing using scripting languages, including shell scripts.</p>
<pre><code class="language-plaintext"># zbd report -csv /dev/nullb0
zone num, type, ofst, len, cap, wp, cond, non_seq, reset
00000, 1, 00000000000000, 00000033554432, 00000033554432, 00000033554432, 0x0, 0, 0
00001, 1, 00000033554432, 00000033554432, 00000033554432, 00000067108864, 0x0, 0, 0
00002, 1, 00000067108864, 00000033554432, 00000033554432, 00000100663296, 0x0, 0, 0
00003, 1, 00000100663296, 00000033554432, 00000033554432, 00000134217728, 0x0, 0, 0
00004, 2, 00000134217728, 00000033554432, 00000033554432, 00000134217728, 0x1, 0, 0
00005, 2, 00000167772160, 00000033554432, 00000033554432, 00000167772160, 0x1, 0, 0
00006, 2, 00000201326592, 00000033554432, 00000033554432, 00000201326592, 0x1, 0, 0
00007, 2, 00000234881024, 00000033554432, 00000033554432, 00000234881024, 0x1, 0, 0
00008, 2, 00000268435456, 00000033554432, 00000033554432, 00000268435456, 0x1, 0, 0
00009, 2, 00000301989888, 00000033554432, 00000033554432, 00000301989888, 0x1, 0, 0
00010, 2, 00000335544320, 00000033554432, 00000033554432, 00000335544320, 0x1, 0, 0
00011, 2, 00000369098752, 00000033554432, 00000033554432, 00000369098752, 0x1, 0, 0
00012, 2, 00000402653184, 00000033554432, 00000033554432, 00000402653184, 0x1, 0, 0
00013, 2, 00000436207616, 00000033554432, 00000033554432, 00000436207616, 0x1, 0, 0
00014, 2, 00000469762048, 00000033554432, 00000033554432, 00000469762048, 0x1, 0, 0
00015, 2, 00000503316480, 00000033554432, 00000033554432, 00000503316480, 0x1, 0, 0
</code></pre>
<h3 id="zone-operations">Zone Operations</h3>
<p>The <em>zbd</em> tool also allow executing zone management operations over a range of
zones. The following example explicitely opens the first 2 sequential zones of
the <em>null_blk</em> device.</p>
<pre><code class="language-plaintext"># zbd open -ofst 134217728 -len 67108864 /dev/nullb0 
# zbd report /dev/nullb0
Zone 00000: cnv, ofst 00000000000000, len 00000033554432, cap 00000033554432
Zone 00001: cnv, ofst 00000033554432, len 00000033554432, cap 00000033554432
Zone 00002: cnv, ofst 00000067108864, len 00000033554432, cap 00000033554432
Zone 00003: cnv, ofst 00000100663296, len 00000033554432, cap 00000033554432
Zone 00004: swr, ofst 00000134217728, len 00000033554432, cap 00000033554432, wp 00000134217728, <mark class="critic">oe</mark>, non_seq 0, reset 0
Zone 00005: swr, ofst 00000167772160, len 00000033554432, cap 00000033554432, wp 00000167772160, <mark class="critic">oe</mark>, non_seq 0, reset 0
Zone 00006: swr, ofst 00000201326592, len 00000033554432, cap 00000033554432, wp 00000201326592, em, non_seq 0, reset 0
Zone 00007: swr, ofst 00000234881024, len 00000033554432, cap 00000033554432, wp 00000234881024, em, non_seq 0, reset 0
Zone 00008: swr, ofst 00000268435456, len 00000033554432, cap 00000033554432, wp 00000268435456, em, non_seq 0, reset 0
Zone 00009: swr, ofst 00000301989888, len 00000033554432, cap 00000033554432, wp 00000301989888, em, non_seq 0, reset 0
Zone 00010: swr, ofst 00000335544320, len 00000033554432, cap 00000033554432, wp 00000335544320, em, non_seq 0, reset 0
Zone 00011: swr, ofst 00000369098752, len 00000033554432, cap 00000033554432, wp 00000369098752, em, non_seq 0, reset 0
Zone 00012: swr, ofst 00000402653184, len 00000033554432, cap 00000033554432, wp 00000402653184, em, non_seq 0, reset 0
Zone 00013: swr, ofst 00000436207616, len 00000033554432, cap 00000033554432, wp 00000436207616, em, non_seq 0, reset 0
Zone 00014: swr, ofst 00000469762048, len 00000033554432, cap 00000033554432, wp 00000469762048, em, non_seq 0, reset 0
Zone 00015: swr, ofst 00000503316480, len 00000033554432, cap 00000033554432, wp 00000503316480, em, non_seq 0, reset 0
</code></pre>
<p>Writing 32MB to the first zone using dd will transition the zone to full state.</p>
<pre><code class="language-plaintext"># dd if=/dev/zero of=/dev/nullb0 oflag=direct bs=1M count=32 seek=128
32+0 records in
32+0 records out
33554432 bytes (34 MB, 32 MiB) copied, 0.00945045 s, 3.6 GB/s
# zbd report /dev/nullb0
Zone 00000: cnv, ofst 00000000000000, len 00000033554432, cap 00000033554432
Zone 00001: cnv, ofst 00000033554432, len 00000033554432, cap 00000033554432
Zone 00002: cnv, ofst 00000067108864, len 00000033554432, cap 00000033554432
Zone 00003: cnv, ofst 00000100663296, len 00000033554432, cap 00000033554432
Zone 00004: swr, ofst 00000134217728, len 00000033554432, cap 00000033554432, wp 00000167772160, <mark class="critic">fu</mark>, non_seq 0, reset 0
Zone 00005: swr, ofst 00000167772160, len 00000033554432, cap 00000033554432, wp 00000167772160, oe, non_seq 0, reset 0
Zone 00006: swr, ofst 00000201326592, len 00000033554432, cap 00000033554432, wp 00000201326592, em, non_seq 0, reset 0
Zone 00007: swr, ofst 00000234881024, len 00000033554432, cap 00000033554432, wp 00000234881024, em, non_seq 0, reset 0
Zone 00008: swr, ofst 00000268435456, len 00000033554432, cap 00000033554432, wp 00000268435456, em, non_seq 0, reset 0
Zone 00009: swr, ofst 00000301989888, len 00000033554432, cap 00000033554432, wp 00000301989888, em, non_seq 0, reset 0
Zone 00010: swr, ofst 00000335544320, len 00000033554432, cap 00000033554432, wp 00000335544320, em, non_seq 0, reset 0
Zone 00011: swr, ofst 00000369098752, len 00000033554432, cap 00000033554432, wp 00000369098752, em, non_seq 0, reset 0
Zone 00012: swr, ofst 00000402653184, len 00000033554432, cap 00000033554432, wp 00000402653184, em, non_seq 0, reset 0
Zone 00013: swr, ofst 00000436207616, len 00000033554432, cap 00000033554432, wp 00000436207616, em, non_seq 0, reset 0
Zone 00014: swr, ofst 00000469762048, len 00000033554432, cap 00000033554432, wp 00000469762048, em, non_seq 0, reset 0
Zone 00015: swr, ofst 00000503316480, len 00000033554432, cap 00000033554432, wp 00000503316480, em, non_seq 0, reset 0
</code></pre>
<p>Other possible zone operations are <em>close</em>, <em>reset</em> and <em>finish</em>.</p>
<h3 id="graphical-interface">Graphical Interface</h3>
<p><em>gzbd</em> provides a graphical user interface showing the zone configuration and
state of a zoned block device. <em>gzbd</em> also  displays  the  write status (write
pointer position) of zones graphically using color coding (red for written
sectors and green for unwritten sectors). Operations on zones can also be
executed directly from the interface (reset zone write pointer, open zone,
close zone, etc).</p>
<p><center>
<img alt="gzbd" src="../../assets/img/projects-libzbd-gzbd.png" title="*gzbd* screenshot" />
<br><em>gzbd screenshot</em></br>
</center></p>
<p>The <em>gzbd-viewer</em> graphical interface is a simpler tool than <em>gzbd</em> that only
allows displaying the current zone condition and state of a zoned block device.
The zone state is refreshed by defaul twice per second. This period can be
adjusted using a command line option.</p>
<p><center>
<img alt="gzbd-viewer" src="../../assets/img/projects-libzbd-gzbd-viewer.png" title="*gzbd-viewer* screenshot" />
<br><em>gzbd-viewer screenshot</em></br>
</center></p>
<p>Using <em>gzbd</em> enables simple visual cues as to how an application is performaing
and using the zones of a zoned block device. The following example illustrates
this.</p>
<video style="width:100%" controls>
  <source src="/assets/img/projects-libzbd-gzbd-viewer-example.mp4" type="video/mp4">
*Application execution observed with gzbd-viewer*
</video></div>
        
        
    </div>
    

    <footer class="col-md-12 text-center">
        
        <span class="text-muted" style="color:hsla(0,0%,100%,.7);font-size:13px;">
	&copy; 2020 Western Digital Corporation or its affiliates. All rights reserved.<br>
        By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use"
	target="_blank" style="color:white;">Terms of Use</a> and
	<a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank" style="color:white;">Privacy Statement</a>.
        All example scripts and program snippets on this site are licensed under
	<a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" style="color:white;">CC0 1.0 Universal</a>.<br>
	Documentation built with <a href="https://www.mkdocs.org/" target="_blank" style="color:white;">MkDocs</a> using a theme
	based on <a href="https://sourcefoundry.org/cinder/" target="_blank" style="color:white;">Cinder</a>.
        </span>
        
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
                <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/languages/c.min.js"></script>
                <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/languages/bash.min.js"></script>
                <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/languages/plaintext.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = "../.."</script>
    
    <script src="../../js/base.js"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
</body>

</html>
