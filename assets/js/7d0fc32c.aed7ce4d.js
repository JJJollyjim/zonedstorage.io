"use strict";(self.webpackChunkzonedstorage_io=self.webpackChunkzonedstorage_io||[]).push([[467],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return f}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var m=r.createContext({}),d=function(e){var t=r.useContext(m),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=d(e.components);return r.createElement(m.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,m=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),c=d(n),f=a,u=c["".concat(m,".").concat(f)]||c[f]||p[f]||i;return n?r.createElement(u,o(o({ref:t},s),{},{components:n})):r.createElement(u,o({ref:t},s))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var m in t)hasOwnProperty.call(t,m)&&(l[m]=t[m]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var d=2;d<i;d++)o[d]=n[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},6942:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return m},toc:function(){return d},default:function(){return p}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],l={id:"libnvme",title:"libnvme User Library",sidebar_label:"libnvme User Library"},m={unversionedId:"tools/libnvme",id:"tools/libnvme",isDocsHomePage:!1,title:"libnvme User Library",description:"libnvme is an open source user library providing defintions and functions for",source:"@site/docs/tools/libnvme.md",sourceDirName:"tools",slug:"/tools/libnvme",permalink:"/docs/tools/libnvme",version:"current",sidebar_label:"libnvme User Library",frontMatter:{id:"libnvme",title:"libnvme User Library",sidebar_label:"libnvme User Library"},sidebar:"docs",previous:{title:"libzbd User Library",permalink:"/docs/tools/libzbd"},next:{title:"tcmu-runner ZBC Disk Emulation",permalink:"/docs/tools/tcmu-runner"}},d=[{value:"Overview",id:"overview",children:[]},{value:"Library Functions",id:"library-functions",children:[]},{value:"Library Types",id:"library-types",children:[]},{value:"Additional Documentation",id:"additional-documentation",children:[]}],s={toc:d};function p(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"libnvme")," is an open source user library providing defintions and functions for\ninteracting with nvme devices. While nvme-cli provides convenient ways for a\nuser to interact with nvme devices from the shell, libnvme provides similiar\naccess for other programs."),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"libnvme")," provides functions for discoverying and managing all nvme devices in\na linux environment. When the NVMe ZNS specification was ratified, libnvme\nincorporated defintions for all the types and commands that specification\nprovides."),(0,i.kt)("p",null,"The library can be used to construct nvme passthrough commands and dispatch\nthese through the Linux nvme driver. For commands that return data, the library\nprovides structures and enumerations to help decode the payloads."),(0,i.kt)("h2",{id:"library-functions"},"Library Functions"),(0,i.kt)("p",null,"All of the ZNS functions provided by ",(0,i.kt)("em",{parentName:"p"},"libnvme"),' are prefixed with the\n"nvme',(0,i.kt)("em",{parentName:"p"},"zns"),'" name.  The following are the admin commands defined from the ZNS\nspecifcation.'),(0,i.kt)("center",null,(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Function"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_identify_ns()"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Retrieves the nvme_zns_id_ns structure")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_identify_ctrl()"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Retrieves the nvme_zns_id_ctrl structure")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_get_log_changed_zones()"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Retrieves the nvme_zns_changed_zone_log structure"))))),(0,i.kt)("p",null,"In addition to admin commands, ZNS also defines new IO commands, and ",(0,i.kt)("em",{parentName:"p"},"libnvme"),"\nprovides the following APIs to send them:"),(0,i.kt)("center",null,(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Function"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_append()"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Append data to a zone")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_mgmt_send()"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Requests an action on one or all zones")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_mgmt_recv()"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Returns data containing information about zones"))))),(0,i.kt)("p",null,"The types of actions that the nvme_zns_mgmt_send() can be done are defined as follows:"),(0,i.kt)("center",null,(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Action"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NVME_ZNS_ZSA_CLOSE"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the zone state to Close")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NVME_ZNS_ZSA_FINISH"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the zone state to Full")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NVME_ZNS_ZSA_OPEN"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the zone state to Open")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NVME_ZNS_ZSA_RESET"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the zone state to Empty")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NVME_ZNS_ZSA_OFFLINE"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the zone state to Offline")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NVME_ZNS_ZSA_SET_DESC_EXT"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Sets the zone descriptor extention data, if available"))))),(0,i.kt)("h2",{id:"library-types"},"Library Types"),(0,i.kt)("p",null,"ZNS created new constant types and structures. The following are the structures\nprovided by ",(0,i.kt)("em",{parentName:"p"},"libnvme")," from the ZNS specification:"),(0,i.kt)("center",null,(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Structure"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_id_ns"),(0,i.kt)("td",{parentName:"tr",align:"left"},"ZNS specific Namespace Identification, returned from nvme_zns_identify_ns()")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_id_ctrl"),(0,i.kt)("td",{parentName:"tr",align:"left"},"ZNS specific Controller Identification, returned from nvme_zns_identify_ctrl()")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zns_changed_zone_log"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Log page that indicaties if a zone descriptor has changed for one or more zones, returned from nvme_zns_get_log_changed_zones()")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"nvme_zone_report"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Provides the structure returned from a ZNS Report Zones command, returned from nvme_zns_mgmt_recv()"))))),(0,i.kt)("h2",{id:"additional-documentation"},"Additional Documentation"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"libnvme")," provides more detailed documentation in html and man pages for all\nfunctions and types."))}p.isMDXComponent=!0}}]);